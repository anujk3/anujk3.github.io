{"pages":[{"title":"About Me","text":"Welcome to Solarized Mode ON. I created this website to share my everyday learnings in the field of Data Science and blog about them. I hope that the issues I face would help other people to learn and it might be easier for them as a reference to some common issues faced by Data Scientists. Many concepts and tools that the data scientists, engineers and technologists use have a steep learning curve, and I hope to make some of those easier to understand for anyone interested. Technology has allowed me to appreciate things in the world that I would have never dreamed of, and this site is a journey of my learning new technologies to help me better understand the world we live in, from a Data Scientist's perspective. I have been fortunate to be a very curious person, and I enjoy wearing many hats. Professionally, I consider myself a Data Scientist who also enjoys software development and is intrigued by the advances in web and mobile app development. My hobbies include reading data science blogs, running, cycling, swimming, watching soccer (FCBarcelona fan). I have been a linux and OSX user and passionate about the open-source world because I do feel that open source contributions to libraries like Pandas, Numpy, Tensorflow, PyTorch have helped advance the field of Data Science which I can relate to with a sense of belongingness. Through this blog, I hope to share some of my frustrations in the world of technology, and maybe beyond. I also find that slowing down every day and just writing, something, helps me channel my thoughts and motivations, and I think this will be an excellent chance to help me to keep writing. So, I hope to be of help to other through tutorials of handy tools and libraries I use on a daily basis, as well as share my adventure in the world data science, engineering, math, programming, linux, open-source things, and whatever else I find interesting. Thanks for reading! Anuj Katiyal","tags":"misc","url":"pages/about-me.html"},{"title":"Adaboost Algorithm using numpy in Python","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Implementation of AdaBoost with Boosting a Linear Regression Based Classifier Data used for this implementation is available at Github Link In [2]: from __future__ import division import numpy as np import matplotlib.pyplot as plt import pandas as pd from tqdm import tqdm % matplotlib inline plt . rcParams [ \"figure.figsize\" ] = ( 10 , 8 ) In [18]: class LeastSquaresRegression ( object ): def __init__ ( self ): self . weights = [] def calcLeastSquares ( self , X , y ): xtranspose = np . transpose ( X ) xtransx = np . dot ( xtranspose , X ) if xtransx . shape [ 0 ] != xtransx . shape [ 1 ]: raise ValueError ( 'Needs to be a square matrix for inverse' ) matinv = np . linalg . inv ( xtransx ) xtransy = np . dot ( xtranspose , y ) self . weights = np . dot ( matinv , xtransy ) def makePredictions ( self , X ): class_output = np . dot ( X , self . weights ) return np . sign ( class_output ) In [19]: class Boosting ( object ): def __init__ ( self , X_train , y_train ): self . X_train = X_train self . N = self . X_train . shape [ 0 ] self . y_train = y_train self . weights = np . ones ( self . N ) / self . N self . epsilont = [] self . alphas = [] self . classifiers = [] self . histogram = {} #self.num_estimators = T def doBoosting ( self ): # for t in range(self.num_estimators): for t in range ( 1500 ): output = np . random . choice ( self . N , self . N , p = self . weights ) for t in output : self . histogram [ t ] = self . histogram . get ( t , 0 ) + 1 # print output B_Xtrain = self . X_train [ output ] B_ytrain = self . y_train [ output ] ls = LeastSquaresRegression () ls . calcLeastSquares ( B_Xtrain , B_ytrain ) # print ls.weights Y_pred = ls . makePredictions ( self . X_train ) # print Y_pred e_t = np . sum (( Y_pred != self . y_train ) * self . weights ) # print e_t if e_t > 0.5 : ls . weights = - ls . weights Y_pred = ls . makePredictions ( self . X_train ) e_t = np . sum (( Y_pred != self . y_train ) * self . weights ) # print e_t self . epsilont . append ( e_t ) alpha_t = 0.5 * np . log (( 1 - e_t ) / e_t ) self . alphas . append ( alpha_t ) self . classifiers . append ( ls ) # print alpha_t self . weights = self . weights * np . exp ( - alpha_t * Y_pred * self . y_train ) self . weights = self . weights / np . sum ( self . weights ) In [20]: X_train = np . genfromtxt ( 'boosting/X_train.csv' , delimiter = ',' ) y_train = np . genfromtxt ( 'boosting/y_train.csv' ) X_test = np . genfromtxt ( 'boosting/X_test.csv' , delimiter = ',' ) y_test = np . genfromtxt ( 'boosting/y_test.csv' ) def append_column_one ( data ): append_ones = np . ones (( data . shape [ 0 ], 1 )) data = np . hstack (( append_ones , data )) return data X_train = append_column_one ( X_train ) X_test = append_column_one ( X_test ) In [21]: training_error = [] testing_error = [] boost = Boosting ( X_train , y_train ) boost . doBoosting () for t in tqdm ( range ( 1 , 1501 )): sum_train = np . zeros ( X_train . shape [ 0 ]) sum_test = np . zeros ( X_test . shape [ 0 ]) for i in range ( t ): alpha = boost . alphas [ i ] classifier = boost . classifiers [ i ] # print X_train.shape # print classifier.weights.shape # print np.dot(X_train, classifier.weights).shape sum_train += ( alpha * classifier . makePredictions ( X_train )) sum_test += ( alpha * classifier . makePredictions ( X_test )) fboost_train_pred = np . sign ( sum_train ) fboost_test_pred = np . sign ( sum_test ) training_error . append ( np . sum ( fboost_train_pred != y_train ) / y_train . shape [ 0 ]) testing_error . append ( np . sum ( fboost_test_pred != y_test ) / y_test . shape [ 0 ]) 100%|██████████| 1500/1500 [00:50<00:00, 29.75it/s] (a) Plotting the testing vs training error for t = 1, 2, ... 1500 In [22]: plt . figure () plt . plot ( range ( 1 , 1501 ), training_error , label = \"Training error\" ) plt . plot ( range ( 1 , 1501 ), testing_error , label = \"Testing error\" ) plt . title ( \"Training and Testing error of fboost(t) for t = 1, 2, ... 1500\" ) plt . legend () plt . show () (b) Upper bound on the training error as a function of t In [23]: training_upper_bound = [] for t in tqdm ( range ( 1 , 1501 )): ub = 0 for i in range ( t ): epsilon = boost . epsilont [ i ] ub += np . power (( 0.5 - epsilon ), 2 ) training_upper_bound . append ( np . exp ( - 2 * ub )) 100%|██████████| 1500/1500 [00:05<00:00, 272.81it/s] In [24]: plt . figure () plt . plot ( range ( 1 , 1501 ), training_upper_bound , label = \"upper bound line\" ) plt . title ( \"Upper bound of training error as a function of t\" ) plt . legend () plt . show () (c) Histogram of the dimensions In [25]: plt . figure () plt . stem ( list ( boost . histogram . keys ()), boost . histogram . values (), color = 'g' ) plt . xlabel ( \"Dimensions\" ) plt . ylabel ( \"Count of the dimensions\" ) plt . show () In [26]: #np.sum(boost.histogram.values()) (d) Epsilon and Alpha as a function of t In [27]: ## Epsilon plt . figure () plt . plot ( range ( 1 , 1501 ), boost . epsilont ) plt . title ( \"Epsilon as a function of t\" ) plt . show () In [28]: ## Alphas plt . figure () plt . plot ( range ( 1 , 1501 ), boost . alphas ) plt . title ( \"Alphas as a function of t\" ) plt . show () if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Machine Learning","url":"blog/2017/10/24/ml-adaboost/"},{"title":"Naive Bayes Algorithm using numpy in Python","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Predict if a mail is spam or not Data Description: Refer: https://archive.ics.uci.edu/ml/datasets/spambase for detailed data description Number of Observations: 4601 (1813 Spam = 39.4%) Number of Attributes: 58 (57 continuous, 1 nominal class label) Attributes 48 continuous real [0,100] attributes of type word_freq_WORD = percentage of words in the e-mail that match WORD, i.e. 100 * (number of times the WORD appears in the e-mail) / total number of words in e-mail. A \"word\" in this case is any string of alphanumeric characters bounded by non-alphanumeric characters or end-of-string. 6 continuous real [0,100] attributes of type char_freq_CHAR] = percentage of characters in the e-mail that match CHAR, i.e. 100 * (number of CHAR occurences) / total characters in e-mail 1 continuous real [1,...] attribute of type capital_run_length_average = average length of uninterrupted sequences of capital letters 1 continuous integer [1,...] attribute of type capital_run_length_longest = length of longest uninterrupted sequence of capital letters 1 continuous integer [1,...] attribute of type capital_run_length_total = sum of length of uninterrupted sequences of capital letters = total number of capital letters in the e-mail 1 nominal {0,1} class attribute of type spam = denotes whether the e-mail was considered spam (1) or not (0), i.e. unsolicited commercial e-mail. Naive Bayes Classifier Under the iid assumption, the optimum classifier is: \\begin{equation} f(x) = arg\\ \\underset{y \\in Y}{max}\\ P \\left(Y = y\\ |\\ X = x\\right) \\end{equation} Applying Bayes Rule we split the posterior into class prior and class conditional distribution of X \\begin{equation} f(x) = arg\\ \\underset{y \\in Y}{max}\\ P \\left(Y = y\\right) \\times P\\left(X = x\\ |\\ Y = y\\right) \\end{equation} Naive Bayes classifier treats the dimensions of X as conditionally independent given y, hence we get: \\begin{equation} f(x) = arg\\ \\underset{y \\in Y}{max}\\ P \\left(Y = y\\right) \\times \\prod&#94;{d}_{j=1} p_j \\left(x[j]|Y=y \\right) \\end{equation} Data used for this implementation is available at Github Link Implementation In [2]: ## Imports and Loading Data import numpy as np import matplotlib.pyplot as plt import operator #import scipy from scipy.special import expit % matplotlib inline X_train = np . genfromtxt ( 'hw2-data/X_train.csv' , delimiter = ',' ) y_train = np . genfromtxt ( 'hw2-data/y_train.csv' ) X_test = np . genfromtxt ( 'hw2-data/X_test.csv' , delimiter = ',' ) y_test = np . genfromtxt ( 'hw2-data/y_test.csv' ) In [3]: def get_prior ( y_train ): train_inputs = y_train unique_labels , counts = np . unique ( train_inputs , return_counts = True ) output = {} for i , label in enumerate ( unique_labels ): output [ int ( label )] = float ( counts [ i ]) / len ( train_inputs ) return output In [4]: def bernoulli_MLE ( feature_col , y_train ): possible_labels = np . unique ( y_train ) output = [] for label in possible_labels : if int ( label ) == 0 : output . append ( float ( np . sum ( feature_col ) - np . sum ( feature_col * y_train )) / ( len ( y_train ) - np . sum ( y_train ))) else : output . append ( float ( np . sum ( feature_col * y_train )) / np . sum ( y_train )) return output In [5]: def pareto_MLE ( feature_col , y_train ): possible_labels = np . unique ( y_train ) output = [] for label in possible_labels : if int ( label ) == 0 : output . append ( float ( len ( y_train ) - np . sum ( y_train )) / np . sum (( 1 - y_train ) * np . log ( feature_col ))) else : output . append ( float ( np . sum ( y_train )) / np . sum ( np . log ( feature_col ) * y_train )) return output In [6]: def get_MLE_features ( X_train , y_train ): MLE_vector = [] for feature_col in xrange ( 0 , X_train . shape [ 1 ]): if feature_col < 54 : MLE_vector . append ( bernoulli_MLE ( X_train [:, feature_col ], y_train )) else : MLE_vector . append ( pareto_MLE ( X_train [:, feature_col ], y_train )) return MLE_vector In [7]: def getBernoulliDist ( MLE_vector , feature_val , label ): return np . power ( MLE_vector [ label ], feature_val ) * np . power (( 1 - MLE_vector [ label ]), ( 1 - feature_val )) In [8]: def getParetoDist ( MLE_vector , feature_val , label ): return MLE_vector [ label ] * np . power ( feature_val , - ( MLE_vector [ label ] + 1 )) In [9]: def BayesClassifier ( X_train , y_train , X_test , y_test ): MLE_vector = get_MLE_features ( X_train , y_train ) priors = get_prior ( y_train ) possible_labels = np . unique ( y_train ) predicted_outputs = [] for i , x_test_vector in enumerate ( X_test ): output_vector = [] for label in possible_labels : label = int ( label ) output = 1 for i , feature_val in enumerate ( x_test_vector ): if i < 54 : output = output * getBernoulliDist ( MLE_vector [ i ], feature_val , label ) else : output = output * getParetoDist ( MLE_vector [ i ], feature_val , label ) output = output * priors [ label ] output_vector . append ( output ) predicted_outputs . append ( output_vector ) return predicted_outputs In [10]: def show_confusion_matrix ( tp , fp , tn , fn , class_labels = [ '0' , '1' ]): fig = plt . figure ( figsize = ( 6 , 4 )) ax = fig . add_subplot ( 111 ) # Draw the grid boxes ax . set_xlim ( - 0.5 , 1.5 ) ax . set_ylim ( 1.5 , - 0.5 ) ax . plot ([ - 0.5 , 1.5 ],[ 0.5 , 0.5 ], '-k' , lw = 2 ) ax . plot ([ - 0.5 , 1.5 ],[ 1.5 , 1.5 ], '-k' , lw = 2 ) ax . plot ([ 0.5 , 0.5 ],[ - 0.5 , 1.5 ], '-k' , lw = 2 ) ax . plot ([ 1.5 , 1.5 ],[ - 0.5 , 1.5 ], '-k' , lw = 2 ) # Set xlabels ax . set_xlabel ( 'Predicted Label' , fontsize = 16 ) ax . set_xticks ([ 0 , 1 ]) ax . set_xticklabels ( class_labels + [ '' ]) ax . xaxis . set_label_position ( 'top' ) ax . xaxis . tick_top () # These coordinate might require some tinkering. Ditto for y, below. ax . xaxis . set_label_coords ( 0.5 , 1.16 ) # Set ylabels ax . set_ylabel ( 'True Label' , fontsize = 16 , rotation = 90 ) ax . set_yticklabels ( class_labels + [ '' ], rotation = 90 ) ax . set_yticks ([ 0 , 1 ]) ax . yaxis . set_label_coords ( - 0.09 , 0.45 ) # Fill in initial metrics: tp, tn, etc... ax . text ( 0 , 0 , 'True Negative: %d ' % ( tn ), va = 'center' , ha = 'center' , bbox = dict ( fc = 'w' , boxstyle = 'round,pad=1' )) ax . text ( 0 , 1 , 'False Negative: %d ' % fn ,va='center',ha='center',bbox=dict(fc='w',boxstyle='round,pad=1')) ax . text ( 1 , 0 , 'False Positive: %d ' % fp ,va='center',ha='center',bbox=dict(fc='w',boxstyle='round,pad=1')) ax . text ( 1 , 1 , 'True Positive: %d ' % ( tp ), va = 'center' , ha = 'center' , bbox = dict ( fc = 'w' , boxstyle = 'round,pad=1' )) ax . text ( 2 , 0.5 , r 'Prediction Accuracy = (54 + 32)/93 = 0.9247 or 92.47%' , fontsize = 15 ) plt . tight_layout () plt . show () In [11]: def prediction_accuracy_Bayes ( predicted_values , y_test ): predicted_classes = [] for a , b in predicted_values : if a > b : predicted_classes . append ( 0 ) else : predicted_classes . append ( 1 ) total = 0 tp = 0 fp = 0 tn = 0 fn = 0 for i in xrange ( len ( predicted_classes )): if predicted_classes [ i ] == y_test [ i ]: total += 1 if ( predicted_classes [ i ] == 0 ) and ( y_test [ i ] == 0 ): tn += 1 if ( predicted_classes [ i ] == 0 ) and ( y_test [ i ] == 1 ): fn += 1 if ( predicted_classes [ i ] == 1 ) and ( y_test [ i ] == 0 ): fp += 1 if ( predicted_classes [ i ] == 1 ) and ( y_test [ i ] == 1 ): tp += 1 return float ( total ) / len ( predicted_classes ), tp , fp , tn , fn In [12]: predicted_values = BayesClassifier ( X_train , y_train , X_test , y_test ) In [1]: #predicted_values In [50]: accuracy , tp , fp , tn , fn = prediction_accuracy_Bayes ( predicted_values , y_test ) #print accuracy #print tp, fp, tn, fn Output Confusion Matrix In [51]: show_confusion_matrix ( tp , fp , tn , fn ) b) Stem Plot in Matplotlib In [52]: MLE_parameters = get_MLE_features ( X_train , y_train ) bernoulli_MLE_parameters = MLE_parameters [ 0 : 54 ] class_zero , class_one = zip ( * bernoulli_MLE_parameters ) In [53]: plt . close ( 'all' ) f , ( ax1 ) = plt . subplots ( 1 , 1 , figsize = ( 15 , 6 )) markerline , stemlines , baseline = ax1 . stem ( range ( 1 , 55 ), class_zero , '-.' ) plt . setp ( baseline , 'color' , 'g' , 'linewidth' , 2 ) plt . setp ( markerline , 'markerfacecolor' , 'r' ) plt . setp ( stemlines , 'color' , 'r' ) ax1 . set_xlabel ( \"Dimensions\" ) ax1 . set_ylabel ( \"Bernoulli Parameters\" ) markerline , stemlines , baseline = ax1 . stem ( range ( 1 , 55 ), class_one , '-' ) plt . setp ( baseline , 'color' , 'g' , 'linewidth' , 2 ) plt . setp ( markerline , 'markerfacecolor' , 'y' ) plt . setp ( stemlines , 'color' , 'y' , 'alpha' , 0.5 ) plt . legend ([ \"Class 0\" , \"Class 1\" ], loc = 'best' , numpoints = 2 ) plt . title ( \"Plot for Bernoulli Parameters when y = 0 (Red) and y = 1 (Yellow)\" ) plt . show () Use the file spambase.names to make an observation about dimensions 16 and 52 The dimension 16 is the word frequency for \"Free\". For Class 0, the MLE estimate is 0.0911 as compard to for Class 1, the MLE estimate is 0.545. So, we can say that for Class 0 (not a spam mail) the likelihood of seeing the word free is 0.091 as compared to Class 1 (spam mail) where it is 0.545. The dimension 52 is the char frequency for \"!\". For Class 0, the MLE estimate is 0.269 as compard to for Class 1, the MLE estimate is 0.833. So, we can say that for Class 0 (not a spam mail) the likelihood of seeing the word free is 0.269 as compared to Class 1 (spam mail) where it is 0.833. Since the Bernoulli parameters are just the average number of documents that have X = x (\"free\" or \"!\") when y = 1 (or 0), we can say that given a spam mail, there is a higher probability for the occurrence of \"!\" and \"free\" as compared to a non-spam mail. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Machine Learning","url":"blog/2017/10/21/ml-nb/"},{"title":"K-Nearest Neighbors using numpy in Python","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Objective: Predict if a mail is spam or not Data Description: Refer: https://archive.ics.uci.edu/ml/datasets/spambase for detailed data description Number of Observations: 4601 (1813 Spam = 39.4%) Number of Attributes: 58 (57 continuous, 1 nominal class label) Attributes 48 continuous real [0,100] attributes of type word_freq_WORD = percentage of words in the e-mail that match WORD, i.e. 100 * (number of times the WORD appears in the e-mail) / total number of words in e-mail. A \"word\" in this case is any string of alphanumeric characters bounded by non-alphanumeric characters or end-of-string. 6 continuous real [0,100] attributes of type char_freq_CHAR] = percentage of characters in the e-mail that match CHAR, i.e. 100 * (number of CHAR occurences) / total characters in e-mail 1 continuous real [1,...] attribute of type capital_run_length_average = average length of uninterrupted sequences of capital letters 1 continuous integer [1,...] attribute of type capital_run_length_longest = length of longest uninterrupted sequence of capital letters 1 continuous integer [1,...] attribute of type capital_run_length_total = sum of length of uninterrupted sequences of capital letters = total number of capital letters in the e-mail 1 nominal {0,1} class attribute of type spam = denotes whether the e-mail was considered spam (1) or not (0), i.e. unsolicited commercial e-mail. K-Nearest Neighbors Classifier In this classification technique, the distance between the new point (unlabelled) and all the other labelled points is computed. The K-closest labelled points are obtained and the majority vote of their classes is the class assigned to the unlabelled point. All ties are broken arbitrarily. Data used for this implementation is available at Github Link k-NN Algorithm for k = 1, 2 ... 20 In [55]: ## Imports and Loading Data import numpy as np import matplotlib.pyplot as plt import operator #import scipy from scipy.special import expit % matplotlib inline X_train = np . genfromtxt ( 'hw2-data/X_train.csv' , delimiter = ',' ) y_train = np . genfromtxt ( 'hw2-data/y_train.csv' ) X_test = np . genfromtxt ( 'hw2-data/X_test.csv' , delimiter = ',' ) y_test = np . genfromtxt ( 'hw2-data/y_test.csv' ) In [56]: def euclidean_distance ( vector1 , vector2 ): return np . sqrt ( np . sum ( np . power ( vector1 - vector2 , 2 ))) def absolute_distance ( vector1 , vector2 ): return np . sum ( np . absolute ( vector1 - vector2 )) In [57]: def get_neighbours ( X_train , X_test_instance , k ): distances = [] neighbors = [] for i in xrange ( 0 , X_train . shape [ 0 ]): dist = absolute_distance ( X_train [ i ], X_test_instance ) distances . append (( i , dist )) distances . sort ( key = operator . itemgetter ( 1 )) for x in xrange ( k ): #print distances[x] neighbors . append ( distances [ x ][ 0 ]) return neighbors In [58]: def predictkNNClass ( output , y_train ): classVotes = {} for i in xrange ( len ( output )): # print output[i], y_train[output[i]] if y_train [ output [ i ]] in classVotes : classVotes [ y_train [ output [ i ]]] += 1 else : classVotes [ y_train [ output [ i ]]] = 1 sortedVotes = sorted ( classVotes . iteritems (), key = operator . itemgetter ( 1 ), reverse = True ) #print sortedVotes return sortedVotes [ 0 ][ 0 ] In [59]: def kNN_test ( X_train , X_test , Y_train , Y_test , k ): output_classes = [] for i in xrange ( 0 , X_test . shape [ 0 ]): output = get_neighbours ( X_train , X_test [ i ], k ) predictedClass = predictkNNClass ( output , Y_train ) output_classes . append ( predictedClass ) return output_classes In [60]: def prediction_accuracy ( predicted_labels , original_labels ): count = 0 for i in xrange ( len ( predicted_labels )): if predicted_labels [ i ] == original_labels [ i ]: count += 1 #print count, len(predicted_labels) return float ( count ) / len ( predicted_labels ) In [61]: predicted_classes = {} final_accuracies = {} for k in xrange ( 1 , 21 ): predicted_classes [ k ] = kNN_test ( X_train , X_test , y_train , y_test , k ) final_accuracies [ k ] = prediction_accuracy ( predicted_classes [ k ], y_test ) Showing Prediction Accuracy as a function of K In [62]: plt . figure ( figsize = ( 15 , 6 )) plt . plot ( final_accuracies . keys (), final_accuracies . values ()) plt . xticks ( final_accuracies . keys ()) plt . xlabel ( \"k\" ) plt . ylabel ( \"Accuracy\" ) plt . title ( \"Plot of the prediction accuracy of KNN Classifier as a function of k (Number of Neighbours)\" ) plt . show () Showing Prediction Accuracy as a function of K (adjusted y-scale to between 0-1) In [63]: plt . figure ( figsize = ( 15 , 6 )) plt . plot ( final_accuracies . keys (), final_accuracies . values ()) plt . ylim ([ 0 , 1 ]) plt . xticks ( final_accuracies . keys ()) plt . xlabel ( \"k\" ) plt . ylabel ( \"Accuracy\" ) plt . title ( \"Plot of the prediction accuracy of KNN Classifier as a function of k (Number of Neighbours), rescaled Y\" ) plt . show () if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Machine Learning","url":"blog/2017/10/01/ml-knn/"},{"title":"In-class Kaggle Classification Challenge for Bank's Marketing Campaign","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } The data is related with direct marketing campaigns of a Portuguese banking institution. The marketing campaigns were based on phone calls. Often, more than one contact to the same client was required, in order to access if the product (bank term deposit) would be ('yes') or not ('no') subscribed. Dataset can be downloaded at Github Link Data Description Bank client data 1 - age (numeric) 2 - job : type of job (categorical: 'admin.','blue-collar','entrepreneur','housemaid','management','retired','self-employed','services','student','technician','unemployed','unknown') 3 - marital : marital status (categorical: 'divorced','married','single','unknown'; note: 'divorced' means divorced or widowed) 4 - education (categorical:'basic.4y','basic.6y','basic.9y','high.school','illiterate','professional.course','university.degree','unknown') 5 - default: has credit in default? (categorical: 'no','yes','unknown') 6 - housing: has housing loan? (categorical: 'no','yes','unknown') 7 - loan: has personal loan? (categorical: 'no','yes','unknown') Related with the last contact of the current campaign 8 - contact: contact communication type (categorical: 'cellular','telephone') 9 - month: last contact month of year (categorical: 'jan', 'feb', 'mar', ..., 'nov', 'dec') 10 - day_of_week: last contact day of the week (categorical: 'mon','tue','wed','thu','fri') 11 - duration: last contact duration, in seconds (numeric). Important note: this attribute highly affects the output target (e.g., if duration=0 then y='no'). Yet, the duration is not known before a call is performed. Also, after the end of the call y is obviously known. Thus, this input should only be included for benchmark purposes and should be discarded if the intention is to have a realistic predictive model. Other attributes 12 - campaign: number of contacts performed during this campaign and for this client (numeric, includes last contact) 13 - pdays: number of days that passed by after the client was last contacted from a previous campaign (numeric; 999 means client was not previously contacted) 14 - previous: number of contacts performed before this campaign and for this client (numeric) 15 - poutcome: outcome of the previous marketing campaign (categorical: 'failure','nonexistent','success') Social and Economic context attributes 16 - emp.var.rate: employment variation rate - quarterly indicator (numeric) 17 - cons.price.idx: consumer price index - monthly indicator (numeric) 18 - cons.conf.idx: consumer confidence index - monthly indicator (numeric) 19 - euribor3m: euribor 3 month rate - daily indicator (numeric) 20 - nr.employed: number of employees - quarterly indicator (numeric) Import Libraries, Load Data In [1]: #write code below, you can make multiple cells import pandas as pd import numpy as np from sklearn.linear_model import LogisticRegressionCV , LogisticRegression from sklearn.svm import LinearSVC from sklearn.neighbors import KNeighborsClassifier , NearestCentroid from sklearn.model_selection import cross_val_score from sklearn.feature_selection import f_regression , f_classif from sklearn.model_selection import GridSearchCV , StratifiedKFold , StratifiedShuffleSplit from sklearn.naive_bayes import MultinomialNB , BernoulliNB , GaussianNB from sklearn.linear_model import SGDClassifier , LassoCV from sklearn.svm import LinearSVC from sklearn.ensemble import RandomForestClassifier , GradientBoostingClassifier , VotingClassifier from sklearn.tree import DecisionTreeClassifier from sklearn.feature_selection import mutual_info_classif from sklearn.feature_selection import SelectFromModel from sklearn.calibration import CalibratedClassifierCV from sklearn.preprocessing import StandardScaler , OneHotEncoder from sklearn.pipeline import Pipeline from sklearn.pipeline import make_pipeline from sklearn.metrics import f1_score from sklearn.metrics import roc_auc_score from sklearn.feature_selection import RFECV from sklearn.model_selection import train_test_split from sklearn.preprocessing import PolynomialFeatures , MinMaxScaler , MaxAbsScaler from sklearn.feature_selection import VarianceThreshold , SelectPercentile from sklearn.kernel_approximation import Nystroem from sklearn.neural_network import MLPClassifier from imblearn.under_sampling import RandomUnderSampler from imblearn.pipeline import make_pipeline as make_imb_pipeline from imblearn.over_sampling import RandomOverSampler from imblearn.under_sampling import EditedNearestNeighbours , CondensedNearestNeighbour # from xgboost import XGBClassifier import matplotlib.pyplot as plt import seaborn as sns % matplotlib inline Loading the data In [2]: plt . rcParams [ \"figure.dpi\" ] = 100 data_df = pd . read_csv ( \"./data/data.csv\" ) data_df . drop ( \"duration\" , axis = 1 , inplace = True ) holdout_df = pd . read_csv ( \"./data/holdout.csv\" ) holdout_df . drop ( \"duration\" , axis = 1 , inplace = True ) subscribed = data_df . subscribed data_df = data_df . drop ( \"subscribed\" , axis = 1 ) subscribed = subscribed == \"yes\" data_df . head () Out[2]: age job marital_status education credit_default housing loan contact month day_of_week campaign prev_days prev_contacts prev_outcomes emp_var_rate cons_price_idx cons_conf_idx euribor3m nr_employed 0 41.0 blue-collar married basic.9y no yes no cellular apr mon 2.0 999 0 nonexistent -1.695118 92.698705 -46.727552 1.345160 5097.0 1 46.0 entrepreneur married unknown no no no cellular may wed 2.0 999 0 nonexistent -1.767159 92.914878 -46.313088 1.314499 5100.0 2 56.0 unemployed married basic.9y no yes yes cellular nov fri 1.0 999 0 nonexistent -0.100365 93.423076 -41.904559 4.003471 5193.0 3 89.0 retired divorced basic.4y no yes no cellular may wed 4.0 999 0 nonexistent -1.771314 93.672814 -46.045500 1.261668 5100.0 4 34.0 entrepreneur married university.degree unknown yes no cellular jul thu 8.0 999 0 nonexistent 1.458103 94.296285 -42.455877 5.152077 5233.0 In [3]: data_df . shape Out[3]: (32950, 19) Step1 - Exploration and Preparation Exploration: Descriptive Statistics for Continuous Variables In [4]: #write code below, you can make multiple cells # Summary statistics of quantitative variables and categorical variables data_df . describe () Out[4]: age campaign prev_days prev_contacts emp_var_rate cons_price_idx cons_conf_idx euribor3m nr_employed count 32950.000000 32950.000000 32950.000000 32950.000000 32950.000000 32950.000000 32950.000000 32950.000000 32950.000000 mean 40.019059 2.641639 961.537906 0.174385 0.080115 93.583705 -40.496740 3.618901 5166.932832 std 10.850807 2.803230 189.209917 0.498989 1.573180 1.162662 4.645301 1.737149 72.439480 min 17.000000 1.000000 0.000000 0.000000 -3.695294 88.311974 -52.220779 0.325461 4963.600000 25% 32.000000 1.000000 999.000000 0.000000 -1.724208 92.800661 -43.087110 1.377065 5101.000000 50% 38.000000 2.000000 999.000000 0.000000 1.085053 93.586959 -41.685507 4.800570 5194.000000 75% 47.000000 3.000000 999.000000 0.000000 1.366367 94.381404 -36.404580 4.943674 5226.000000 max 97.000000 56.000000 999.000000 7.000000 1.785673 98.263042 -25.323735 5.362403 5249.000000 We make the following observations from the descriptive statistics above: The variables 'prev_days' has many '999' (missing) values. 'prev_contacts' = 0 for most of the data Rest of the continuous variables seem clean and well populated. Descriptive Statistics for Categorical Variables In [5]: data_df . describe ( include = [ \"object\" ]) Out[5]: job marital_status education credit_default housing loan contact month day_of_week prev_outcomes count 32950 32950 32950 32950 32950 32950 32950 32950 32950 32950 unique 12 4 8 3 3 3 2 10 5 3 top admin. married university.degree no yes no cellular may thu nonexistent freq 8342 19955 9760 26059 17176 27179 20902 11016 6945 28423 We have 10 categorical variables In [6]: categorical_vars = data_df . describe ( include = [ \"object\" ]) . columns continuous_vars = data_df . describe () . columns In [7]: continuous_vars Out[7]: Index(['age', 'campaign', 'prev_days', 'prev_contacts', 'emp_var_rate', 'cons_price_idx', 'cons_conf_idx', 'euribor3m', 'nr_employed'], dtype='object') In [8]: categorical_vars Out[8]: Index(['job', 'marital_status', 'education', 'credit_default', 'housing', 'loan', 'contact', 'month', 'day_of_week', 'prev_outcomes'], dtype='object') Visualizing Distribution of Continuous Variables In [9]: _ = data_df . hist ( column = continuous_vars , figsize = ( 16 , 16 )) Visualizing Distribution of Categorical Variables In [10]: # Count plots of categorical variables fig , axes = plt . subplots ( 4 , 3 , figsize = ( 16 , 16 )) plt . subplots_adjust ( left = None , bottom = None , right = None , top = None , wspace = 0.7 , hspace = 0.3 ) for i , ax in enumerate ( axes . ravel ()): if i > 9 : ax . set_visible ( False ) continue sns . countplot ( y = categorical_vars [ i ], data = data_df , ax = ax ) Scatter Plot Matrix for checking Correlations (takes long to build on travis, commented) In [11]: #pd.tools.plotting.scatter_matrix(data_df[continuous_vars], c=subscribed, alpha=.2, figsize=(15, 15), cmap=\"viridis\"); Preparation Creating dummy variables for categorical variables Scaling numerical variables Removing variables based on variance Creating Dummy Variables In [12]: data_df . head () Out[12]: age job marital_status education credit_default housing loan contact month day_of_week campaign prev_days prev_contacts prev_outcomes emp_var_rate cons_price_idx cons_conf_idx euribor3m nr_employed 0 41.0 blue-collar married basic.9y no yes no cellular apr mon 2.0 999 0 nonexistent -1.695118 92.698705 -46.727552 1.345160 5097.0 1 46.0 entrepreneur married unknown no no no cellular may wed 2.0 999 0 nonexistent -1.767159 92.914878 -46.313088 1.314499 5100.0 2 56.0 unemployed married basic.9y no yes yes cellular nov fri 1.0 999 0 nonexistent -0.100365 93.423076 -41.904559 4.003471 5193.0 3 89.0 retired divorced basic.4y no yes no cellular may wed 4.0 999 0 nonexistent -1.771314 93.672814 -46.045500 1.261668 5100.0 4 34.0 entrepreneur married university.degree unknown yes no cellular jul thu 8.0 999 0 nonexistent 1.458103 94.296285 -42.455877 5.152077 5233.0 In [13]: # Creating dummy variables data_dummies_df = pd . get_dummies ( data_df , columns = categorical_vars , drop_first = True ) holdout_dummies_df = pd . get_dummies ( holdout_df , columns = categorical_vars , drop_first = True ) In [14]: #data_dummies_df.columns In [15]: output_df = pd . DataFrame ( holdout_df [ \"ID\" ]) holdout_dummies_df . drop ( \"ID\" , axis = 1 , inplace = True ) In [16]: #holdout_dummies_df.columns In [17]: holdout_dummies_df [ 'credit_default_yes' ] = 0 holdout_dummies_df = holdout_dummies_df [ data_dummies_df . columns ] Creating Submission Output Create the output.csv to upload on Kaggle In [18]: def create_submission_output ( output_df , pipe ): output = pd . concat ([ output_df , pd . DataFrame ( pipe . predict_proba ( holdout_dummies_df )[:, 1 ])], axis = 1 ) output . rename ( columns = { 0 : \"subscribed\" }, inplace = True ) output . set_index ( \"ID\" ) . to_csv ( \"output.csv\" ) return output . head () Step2 - ModelSet1 In this step, the following steps relevant to the Machine Learning models used have been shown: feature engineering validation feature selection final model selection 1. Logisitc Regression CV with StandardScalar (a) First we build a simple logistic regression model by standardizing all the features using the Standard scaler. Standard Scaling just the continuous Variables In [19]: categorical_dummies = pd . get_dummies ( data_df [ categorical_vars ], drop_first = True ) . columns In [20]: from sklearn.preprocessing import FunctionTransformer from sklearn.pipeline import make_union select_categorical = FunctionTransformer ( lambda X : X [ categorical_dummies ], validate = False ) select_continuous = FunctionTransformer ( lambda X : X [ continuous_vars ], validate = False ) fu = make_union ( select_categorical , make_pipeline ( select_continuous , StandardScaler ())) pipe = make_pipeline ( fu , LogisticRegressionCV ()) print ( np . mean ( cross_val_score ( pipe , data_dummies_df , subscribed , cv = 5 , scoring = \"roc_auc\" ))) 0.789408598048 In [21]: pipe . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , pipe ) Standard Scaling all the features In [22]: pipe = make_pipeline ( StandardScaler (), LogisticRegressionCV ()) print ( np . mean ( cross_val_score ( pipe , data_dummies_df , subscribed , cv = 5 , scoring = \"roc_auc\" ))) 0.791280720729 In [23]: pipe . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , pipe ) Out[23]: Pipeline(steps=[('standardscaler', StandardScaler(copy=True, with_mean=True, with_std=True)), ('logisticregressioncv', LogisticRegressionCV(Cs=10, class_weight=None, cv=None, dual=False, fit_intercept=True, intercept_scaling=1.0, max_iter=100, multi_class='ovr', n_jobs=1, penalty='l2', random_state=None, refit=True, scoring=None, solver='lbfgs', tol=0.0001, verbose=0))]) In [24]: plt . figure ( figsize = ( 5 , 15 )) coef = pd . Series ( pipe . named_steps [ 'logisticregressioncv' ] . coef_ . ravel (), index = data_dummies_df . columns ) coef . sort_values () . plot ( kind = \"barh\" ) Out[24]: In one model we standardize only the continuous variables and leave the categorical variables as it is. In another model we standardize all the variables (including categorical variables). The model gives a better cross-val score in the second case. We get an average cross-val score of 78.9%, so we use StandardScaler in all the later models to Scale all the features in the pipeline. Also, looking at the weights assigned to the features, we observe that around 50% of the variables are those with significant weights and therefore we set a feature selection threshold as 50% for a few models later. (b) Logistic Regression with Kernel Next we use kernelized logistic regression to make our prediction. Again we use standard scaler before fitting our model. In [25]: approx = Nystroem ( gamma = 1. / data_dummies_df . shape [ 1 ], n_components = 300 ) pipe = make_pipeline ( StandardScaler (), approx , LogisticRegressionCV ()) print ( np . mean ( cross_val_score ( pipe , data_dummies_df , subscribed , cv = 5 , scoring = \"roc_auc\" ))) In [26]: pipe . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , pipe ) Logistic Regression using Kernel Approximation did not result in an improvement as compared to LogisticRegressionCV with using a Standard Scaler. (c) Logistic Regression with Feature Selection We now perform feature selection using f_classif before fitting a Logistic model on the data. Feature engineering is performed by adding interaction features to our feature set. Top 50 percentile of features are selected using f_classif. In [28]: pipe = make_pipeline ( StandardScaler (), SelectPercentile ( score_func = f_classif , percentile = 50 ), PolynomialFeatures ( interaction_only = True ), VarianceThreshold (), LogisticRegressionCV ()) print ( np . mean ( cross_val_score ( pipe , data_dummies_df , subscribed , cv = 5 , scoring = \"roc_auc\" ))) In [29]: pipe . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , pipe ) In [30]: roc_auc_score ( y_test , pipe . predict_proba ( X_test )[:, 1 ]) We used SelectPercentile with various values in GridSearch, but as the percentage increases, the value increased which shows that even if the logistic weights are lower for a few features, they are still important for classification. (d) SelectFromModel : Lasso with Logistic Regression We wanted to perform feature selection using SelectModel, where we use LassoCV. Threshold was set as the median, by observing the important features using Logistic Regression from part a) In [31]: select_lassocv = SelectFromModel ( LassoCV (), threshold = \"median\" ) pipe_lassocv = make_pipeline ( StandardScaler (), select_lassocv , LogisticRegressionCV ()) print ( np . mean ( cross_val_score ( pipe_lassocv , data_dummies_df , subscribed , cv = 10 , scoring = \"roc_auc\" ))) In [32]: pipe_lassocv . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , pipe_lassocv ) Using SelectfromModel with Lasso, we get comparable CV scores as compared to Logistic Regression with StandardScaler, so we wanted to explore a lot of other parameters using GridSearch. (e) Logistic Regression Parameter Tuning Now we try to tune our hyper-parameters to obtain best hyper-parameters. Since LogisticRegressionCV already tunes 'C' for logistic regression, we tune max_features and polynomial degree . In [33]: pipe = make_pipeline ( SelectPercentile ( score_func = f_classif , percentile = 50 ), PolynomialFeatures ( interaction_only = True ), VarianceThreshold (), LogisticRegressionCV ()) param_grid = { 'selectpercentile__percentile' : [ 50 ], 'polynomialfeatures__degree' : [ 2 ]} grid = GridSearchCV ( pipe , param_grid , cv = 5 , scoring = \"roc_auc\" ) In [34]: grid . fit ( data_dummies_df , subscribed ) In [35]: grid . best_score_ In [36]: grid . best_params_ In [37]: create_submission_output ( output_df , grid ) We obtain a best cross-val roc_auc score of 78.89% after parameter tuning with features selected using f_classif. Observations: For the logistic regression, using the LogisticRegressionCV with just standard scaling works best and its CV score is comparable to the score obtained by doing feature selection using LassoCV. Therefore, we just use the LogisticRegressionCV for our ensemble methods later. 2. MLP Classifier We try another linear classifier, multi-layered perceptron. Takes long time to build on travis, commented In [38]: mlp_pipe = make_pipeline ( StandardScaler (), MLPClassifier ( hidden_layer_sizes = 5 )) param_grid = { 'mlpclassifier__hidden_layer_sizes' : [ 5 , 10 , 50 , 100 , 200 ]} param_grid = {} # to optimize code running on travis, the best value is selected by doing the runs grid = GridSearchCV ( mlp_pipe , param_grid , cv = 5 , scoring = \"roc_auc\" ) In [39]: grid . fit ( data_dummies_df , subscribed ) In [40]: grid . best_score_ In [41]: grid . best_params_ In [42]: create_submission_output ( output_df , grid ) Observations: We tried using the MLPClassifier, but it did not perform that well as compared to LogisticRegressionCV from ModelSet1. 3. LinearSVC Classifier with Calibration We use a calibrated Linear SVM classifier. In [43]: scaled_svc = make_pipeline ( StandardScaler (), LinearSVC ()) clf = CalibratedClassifierCV ( scaled_svc ) print ( np . mean ( cross_val_score ( clf , data_dummies_df , subscribed , cv = 5 , scoring = \"roc_auc\" ))) In [44]: clf . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , clf ) Observations: For the LinearSVC classifiers, as they do not return a predict_proba, we need to use a CalibrationClassifier to get the predict probability values. For the LinearSVC also, we do not beat the CV validation scores in ModelSet1 using LogisticRegression Models. Step3 - ModelSet2 In this step, the following steps relevant to the Machine Learning models used have been shown: feature engineering validation feature selection final model selection 1. Decision Tree Classifier In [45]: pipe = make_pipeline ( DecisionTreeClassifier ( max_depth = 6 )) #param_grid = {'decisiontreeclassifier__max_depth':range(1, 7)} param_grid = {} grid = GridSearchCV ( pipe , param_grid = param_grid , scoring = 'roc_auc' , cv = StratifiedShuffleSplit ( 100 )) grid . fit ( data_dummies_df , subscribed ) In [46]: grid . best_score_ , grid . best_params_ Observations: Using the Decision Trees Classifier, we tried all the parameter values for GridSearch, but it wasn't resulting in comparable CV scores to LogisticRegression, so we moved to better models, i.e., RandomForest and GradientBoosting. 2. Random Forest Classifier We tune our random forest classifier by varying the following hyper-parameters: N-estimators Max Depth Max Features Criterion Tuning Level 1 In [47]: rf = RandomForestClassifier ( warm_start = True ) params = { 'randomforestclassifier__n_estimators' : range ( 10 , 100 , 10 ), 'randomforestclassifier__max_depth' : range ( 3 , 15 , 2 )} pipe = make_pipeline ( rf ) grid = GridSearchCV ( pipe , param_grid = params , scoring = 'roc_auc' , n_jobs =- 1 , iid = False , cv = 5 ) grid . fit ( data_dummies_df , subscribed ) print ( grid . best_score_ ) Tuning Level 2 In [48]: rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 ) params = { 'randomforestclassifier__max_features' : range ( 7 , 53 , 9 ), 'randomforestclassifier__criterion' : [ 'gini' , 'entropy' ]} pipe = make_pipeline ( rf ) grid = GridSearchCV ( pipe , param_grid = params , scoring = 'roc_auc' , n_jobs =- 1 , iid = False , cv = 5 ) grid . fit ( data_dummies_df , subscribed ) print ( grid . best_score_ ) Final Model based on learned Tuned Parameters In [49]: rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' ) params = {} pipe = make_pipeline ( rf ) grid = GridSearchCV ( pipe , param_grid = params , scoring = 'roc_auc' , n_jobs =- 1 , iid = False , cv = 5 ) grid . fit ( data_dummies_df , subscribed ) print ( grid . best_score_ ) 0.798401803402 Observations: All the parameters were tuned for the Random Forest, but here we are showing just two levels of parameter tuning for brevity. Finally we obtain a best cross-val score of 79.79% . As this cross val scores are better than what we obtain for ModelSet1, the Random Forests are good candidates for creating ensembles later. 3. Gradient Boosting Classifier We tune our gradient boosting classifier by varying the following variables: N-estimators learning rate max depth We obtain N-estimators = 80, learning_rate = 0.1, min_samples_split = 1000 and Max_depth = 5 In [50]: param_test = {} pipe = make_pipeline ( GradientBoostingClassifier ( learning_rate = 0.1 , max_depth = 5 , n_estimators = 80 , random_state = 10 , min_samples_split = 1000 )) grid = GridSearchCV ( pipe , param_grid = param_test , scoring = 'roc_auc' , n_jobs =- 1 , iid = True , cv = 5 ) grid . fit ( data_dummies_df , subscribed ) In [51]: if grid . best_score_ > 0.79 : assert True Observations: All the parameters were tuned for the Gradient Boosting Classifier, but as it takes a lot of time to tune the Gradient Boosting Model, we are just showing results for the best tuned model here. Finally we obtain a best cross-val score of 79.6% . As this cross val scores are better than what we obtain for ModelSet1, the Gradient Boosting Methods are good candidates for creating ensembles later. 4. Xgboost We also used XG boost classifier. Since we cannot pip-install XGboost, we fail to run it on Travis therefore we comment our code on XGboost. We have uploaded our output on the kaggle competition. In [52]: n_estimators = [ 50 ] max_depth = [ 5 ] learning_rate = [ 0.1 ] subsample = [ 1.0 ] colsample_bytree = [ 0.7 ] colsample_bylevel = [ 0.6 ] gamma = [ 0.1 , 0.2 , 0.3 , 0.4 , 0.5 , 0.6 , 0.7 , 0.8 , 0.9 , 1.1 ] param_grid = dict ( xgbclassifier__n_estimators = n_estimators , xgbclassifier__max_depth = max_depth , xgbclassifier__learning_rate = learning_rate , xgbclassifier__subsample = subsample , xgbclassifier__colsample_bytree = colsample_bytree , xgbclassifier__colsample_bylevel = colsample_bylevel , xgbclassifier__gamma = gamma ) #kfold = StratifiedKFold(n_splits=5, shuffle=True) pipe = make_pipeline ( StandardScaler (), XGBClassifier ()) grid = GridSearchCV ( pipe , param_grid , scoring = \"roc_auc\" , n_jobs =- 1 , cv = 10 ) grid . fit ( data_dummies_df , subscribed ) In [53]: grid . best_params_ In [54]: grid . best_score_ Observations: All the parameters were tuned for the XGBoost Classifier. The good aspect of using XGBoost is that it is way faster to train as compared to Gradient Boosting, and with regularization helps in learning a better model. Finally we obtain a best cross-val score of 79.8% . As this cross val scores are better than what we obtain for ModelSet1, the XGBoost Methods are good candidates for creating ensembles later. Step4 - Ensemble Methods The aim here was to try poor man's stacking and other ensemble techniques as well. 1. Simple Ensemble: Voting Classifier, Poor-man's Stacking Logistic Regression CV Random Forest with best hyper-parameters, N-estimator = 80, max_depth = 9, max features = 16, criterion = entropy Gradient Boosting Classifier with best hyper-parameters, N-estimators = 200, max_depth = 5, min_samples_split = 1000 In [55]: clf1 = make_pipeline ( StandardScaler (), LogisticRegressionCV ( random_state = 10 )) clf2 = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' , random_state = 10 ) clf3 = GradientBoostingClassifier ( learning_rate = 0.1 , max_depth = 5 , n_estimators = 200 , random_state = 10 , min_samples_split = 1000 ) voting = VotingClassifier ([( 'logreg' , clf1 ),( 'RandomForest' , clf2 ),( 'GradientBoost' , clf3 )], voting = 'soft' ) print ( np . mean ( cross_val_score ( voting , data_dummies_df , subscribed , scoring = 'roc_auc' , cv = 5 ))) In [56]: ## using only voting.fit is POOR MANS STACKING AND USING CROSS_VAL_PREDICT IS ACTUAL STACKING voting . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , voting ) After Voting Classifier, we used Stacking on the output probability from the Voting Classifier and build a LogisticRegression model on those probabilities to obtain the final probability In [57]: from sklearn.preprocessing import FunctionTransformer reshaper = FunctionTransformer ( lambda X_ : np . rollaxis ( X_ , 1 ) . reshape ( - 1 , 6 )[:, 1 :: 2 ], validate = False ) stacking = make_pipeline ( voting , reshaper , LogisticRegressionCV ()) print ( np . mean ( cross_val_score ( stacking , data_dummies_df , subscribed , scoring = 'roc_auc' , cv = 5 ))) In [58]: stacking . fit ( data_df_dummies , subscribed ) create_submission_output ( output_df , stacking ) The second stage stacking was also tried using the RandomForestClassifier, GradientBoosting and LinearRegression classifiers, but as it takes a lot of time to build, we have shown results for LogisticRegression here. Also, it did not help in any accuracy changes. Observations: We are able to achieve the best CV outputs using a Voting Classifier with all the best tuned models from ModelSet1 and ModelSet2. 2. Weighted Ensemble: We use a weighted ensemble model by giving more weightage to the Random Forest Classifier followed by the Gradient Boosting Classifier and Logistic Regression classifier. In [59]: clf1 = make_pipeline ( StandardScaler (), LogisticRegressionCV ( random_state = 10 )) clf2 = make_pipeline ( StandardScaler (), RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' , random_state = 10 )) clf3 = make_pipeline ( StandardScaler (), GradientBoostingClassifier ( learning_rate = 0.1 , max_depth = 5 , n_estimators = 80 , random_state = 10 , min_samples_split = 1000 )) voting = VotingClassifier ([( 'logreg' , clf1 ), ( 'RandomForest' , clf2 ), ( 'GradientBoost' , clf3 )], weights = [ 2 , 5 , 3 ], voting = 'soft' ) output = np . mean ( cross_val_score ( voting , data_dummies_df , subscribed , scoring = 'roc_auc' , cv = 5 )) print ( output ) 0.798568652313 In [60]: voting . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , voting ) Observations: We are able to achieve the best CV outputs using a Voting Classifier with all the best tuned models from ModelSet1 and ModelSet2. It performed well when we were able to provide weights to separate classifiers for their outputs. 3. Ensemble with XGboost In [61]: clf1 = make_pipeline ( StandardScaler (), XGBClassifier ( n_estimators = 50 , max_depth = 5 , learning_rate = 0.1 , subsample = 1.0 , colsample_bylevel = 0.6 , colsample_bytree = 0.7 , gamma = 1.11 )) clf2 = make_pipeline ( StandardScaler (), RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' )) clf3 = make_pipeline ( StandardScaler (), GradientBoostingClassifier ( learning_rate = 0.1 , max_depth = 5 , n_estimators = 200 , random_state = 10 , min_samples_split = 1000 )) voting = VotingClassifier ([( 'xgb' , clf1 ), ( 'RandomForest' , clf2 ), ( 'GradientBoost' , clf3 )], voting = 'soft' , weights = [ 1.5 , 4 , 3 ]) print ( np . mean ( cross_val_score ( voting , data_dummies_df , subscribed , scoring = 'roc_auc' , cv = 10 ))) In [62]: voting . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , voting ) Observation: The cross val roc_auc score does not show any improvement by replacing the Logistic Classifier with XGboost. Although we get a similar roc_auc score of close to 0.786. 4. Ensemble with XGBoost, inspired by Owen Zhang In [63]: clf1 = XGBClassifier ( n_estimators = 50 , max_depth = 5 , learning_rate = 0.1 , subsample = 1.0 , colsample_bytree = 0.7 , colsample_bylevel = 0.6 , gamma = 1.11 , seed = 0 ) clf2 = XGBClassifier ( n_estimators = 50 , max_depth = 5 , learning_rate = 0.1 , subsample = 1.0 , colsample_bytree = 0.7 , colsample_bylevel = 0.6 , gamma = 1.11 , seed = 1 ) clf3 = XGBClassifier ( n_estimators = 50 , max_depth = 5 , learning_rate = 0.1 , subsample = 1.0 , colsample_bytree = 0.7 , colsample_bylevel = 0.6 , gamma = 1.11 , seed = 2 ) voting = VotingClassifier ([( 'xgb1' , clf1 ),( 'xgb2' , clf2 ),( 'xgb3' , clf3 )], voting = 'soft' ) print ( np . mean ( cross_val_score ( voting , data_dummies_df , subscribed , scoring = 'roc_auc' , cv = 5 ))) In [64]: voting . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , voting ) Observation We tried an ensemble of 3 XGboost classifiers with different random states. This was inspired by Owen Zhang technique of acing the kaggle leader-board. We were not able to observe any significant improvement in cross val score over our simple voting classifier. Step 5 : Resampling In this section we tried Resampling with the best parameters learnt for LogisticRegression and RandomForestClassifier, as they run faster 1. Undersampling with Logistic Regression : RandomUnderSampler In [65]: undersample_pipe = make_imb_pipeline ( RandomUnderSampler (), LogisticRegressionCV ()) scores = cross_val_score ( undersample_pipe , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) In [66]: undersample_pipe . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , undersample_pipe ) 2. Oversampling with Logistic Regression : RandomOverSampler In [67]: oversample_pipe = make_imb_pipeline ( RandomOverSampler (), LogisticRegressionCV ()) scores = cross_val_score ( oversample_pipe , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) In [68]: oversample_pipe . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , oversample_pipe ) Observations: Undersampling and Oversampling give similar roc_auc scores close to 0.787 using Logistic Regression classifier 3. Undersampling with Random Forest Classifier : RandomUnderSampler In [69]: undersample_pipe_rf = make_imb_pipeline ( RandomUnderSampler (), RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' )) scores = cross_val_score ( undersample_pipe_rf , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) In [70]: undersample_pipe_rf . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , undersample_pipe_rf ) 4. Oversampling with Random Forest Classifier : RandomOverSampler In [71]: oversample_pipe_rf = make_imb_pipeline ( RandomOverSampler (), RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' )) scores = cross_val_score ( oversample_pipe_rf , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) In [72]: oversample_pipe_rf . fit ( data_dummies_df , subscribed ) create_submission_output ( output_df , oversample_pipe_rf ) Random Over Sampler with our tuned Random Forest Classifier gives a mean roc_auc score of 0.797 . Again we do not observe any significant improvement by resampling the data. 5. Balancing Class Weights for Logistic Regression In [73]: scores = cross_val_score ( LogisticRegression ( class_weight = 'balanced' ), data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( scores . mean ()) 6. Balancing Class Weights for Random Forest Classifier In [74]: from sklearn.ensemble import RandomForestClassifier scores = cross_val_score ( RandomForestClassifier ( n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' , class_weight = 'balanced' ), data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) Resampled Ensembles 1. Trees: RF In this model we create multiple undersampled random-forests classifiers with different random state for undersampling. Finally we build a voting classifier for all these rf classifiers. In [75]: def make_resample_tree ( random_state = 0 ): rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' ) tree = make_imb_pipeline ( RandomUnderSampler ( random_state = random_state , replacement = True ), rf ) return \"tree_i\" . format ( random_state ), tree classifiers = [ make_resample_tree ( i ) for i in range ( 100 )] resampled_rf = VotingClassifier ( classifiers , voting = 'soft' ) In [76]: scores = cross_val_score ( resampled_rf , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) 2. Ensembles using RandomUnderSampling In [77]: from sklearn.base import clone def make_resampled_ensemble ( estimator , n_estimators = 100 ): estimators = [] for i in range ( n_estimators ): est = clone ( estimator ) if hasattr ( est , \"random_state\" ): est . random_state = i pipe = make_imb_pipeline ( RandomUnderSampler ( random_state = i , replacement = True ), est ) estimators . append (( \"est_i\" . format ( i ), pipe )) return VotingClassifier ( estimators , voting = \"soft\" ) For RandomForestClassifier (takes long time to run, so commented for travis) In [78]: rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' ) resampled_tree_test = make_resampled_ensemble ( rf ) scores = cross_val_score ( resampled_tree_test , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) For LogisticRegression (takes long time to run, so commented for travis) In [79]: resampled_lr = make_resampled_ensemble ( LogisticRegressionCV ()) scores = cross_val_score ( resampled_lr , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) Undersampling using Edited Nearest Neigbors (takes long time to run, so commented for travis) In [80]: enn_pipe = make_imb_pipeline ( EditedNearestNeighbours ( n_neighbors = 5 ), LogisticRegressionCV ()) scores = cross_val_score ( enn_pipe , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) In [81]: rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' ) enn_pipe_rf = make_imb_pipeline ( EditedNearestNeighbours ( n_neighbors = 5 ), rf ) scores = cross_val_score ( enn_pipe_rf , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) Undersampling using both EditedNearestNeighbours and CondensedNearestNeighbours were tried in conjunction with both LogisticRegression and RandomForestClassifier. CondensedNearestNeigbours takes a long time to run and does not help in improving the CV score much, so not used and shown here. Resampling using SMOTE In [82]: from imblearn.over_sampling import SMOTE LogisticRegression In [83]: smote_pipe = make_imb_pipeline ( SMOTE (), LogisticRegressionCV ()) scores = cross_val_score ( smote_pipe , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) RandomForestClassifier In [84]: rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' ) smote_pipe_rf = make_imb_pipeline ( SMOTE (), rf ) scores = cross_val_score ( smote_pipe_rf , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) In [85]: param_grid = { 'smote__k_neighbors' : [ 3 , 5 , 7 , 9 , 11 , 15 , 31 ]} search = GridSearchCV ( smote_pipe_rf , param_grid , cv = 10 , scoring = \"roc_auc\" ) search . fit ( data_dummies_df , subscribed ) In [86]: search . best_params_ From best_params_, we obtain the best value for k_neighbours as 7, which are used later SMOTEENN and SMOTETOMEK tried, but code commented due to travis In [87]: rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' ) smote_pipe_rf = make_imb_pipeline ( SMOTE ( k_neighbors = 7 ), rf ) scores = cross_val_score ( smote_pipe_rf , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) In [88]: from imblearn.combine import SMOTEENN , SMOTETomek rf = RandomForestClassifier ( warm_start = True , n_estimators = 80 , max_depth = 9 , max_features = 16 , criterion = 'entropy' ) smoteenn_pipe_rf = make_imb_pipeline ( SMOTEENN ( smote = SMOTE ( k_neighbors = 7 )), rf ) scores = cross_val_score ( smoteenn_pipe_rf , data_dummies_df , subscribed , cv = 10 , scoring = 'roc_auc' ) print ( np . mean ( scores )) The Under and Over Sampling techniques are applied in conjunction with Random Forest Classifier (Best Tree Classifier) The resampling techniques get us CV values near 0.791-0.794, but still are not able to perform as well as Voting Classifiers or classifiers built in ModelSet1 and ModelSet2. The main reason for this can be the skewness of classes and the chosen undersample not being a good representative of all the variation that exists in that class, whereas for the other class, it always has all the variation captured. Similar observations can be made for the Oversampling case. We are using the weighted ensemble method for final results, whose CV value is stored in output :: In [89]: if output > 0.798 : #print(True) assert True if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Machine Learning","url":"blog/2017/10/01/aml-kaggle/"},{"title":"Logistic Regression using numpy in Python","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Predict if a mail is spam or not Data Description: Refer: https://archive.ics.uci.edu/ml/datasets/spambase for detailed data description Number of Observations: 4601 (1813 Spam = 39.4%) Number of Attributes: 58 (57 continuous, 1 nominal class label) Attributes 48 continuous real [0,100] attributes of type word_freq_WORD = percentage of words in the e-mail that match WORD, i.e. 100 * (number of times the WORD appears in the e-mail) / total number of words in e-mail. A \"word\" in this case is any string of alphanumeric characters bounded by non-alphanumeric characters or end-of-string. 6 continuous real [0,100] attributes of type char_freq_CHAR] = percentage of characters in the e-mail that match CHAR, i.e. 100 * (number of CHAR occurences) / total characters in e-mail 1 continuous real [1,...] attribute of type capital_run_length_average = average length of uninterrupted sequences of capital letters 1 continuous integer [1,...] attribute of type capital_run_length_longest = length of longest uninterrupted sequence of capital letters 1 continuous integer [1,...] attribute of type capital_run_length_total = sum of length of uninterrupted sequences of capital letters = total number of capital letters in the e-mail 1 nominal {0,1} class attribute of type spam = denotes whether the e-mail was considered spam (1) or not (0), i.e. unsolicited commercial e-mail. Logistic Regression Logistic regression is a discriminative classifier where Log odds is modelled as a linear function i.e. \\begin{equation} ln \\left( \\frac{p\\left( y = +1|x \\right)}{p \\left(y=-1|x \\right)} \\right) = x&#94;{T}w + w_0 \\end{equation} Hence we get, \\begin{equation} p \\left( y = +1|x \\right) = \\frac{e&#94;{x&#94;Tw + w_0}}{1 + e&#94;{x&#94;Tw + w_0}} = \\sigma (x_i&#94;T w) \\end{equation} The log likelihood function i.e. \\begin{equation} \\sum_{i=1}&#94;{n} ln \\left(\\sigma_{i} \\left(y_i . w \\right) \\right) \\end{equation} is maximized over w using two different optimization algorithms: Steepest Ascent Newton's Method \\begin{equation} w_{ML} = arg\\ \\underset{w}{max} \\sum_{i=1}&#94;{n} ln \\left(\\sigma_{i} \\left(y_i . w \\right) \\right) \\end{equation} Data used for this implementation is available at Github Link Python Implementation In [1]: import numpy as np import matplotlib.pyplot as plt import operator #import scipy from scipy.special import expit import warnings warnings . filterwarnings ( 'ignore' ) % matplotlib inline X_train = np . genfromtxt ( 'hw2-data/X_train.csv' , delimiter = ',' ) y_train = np . genfromtxt ( 'hw2-data/y_train.csv' ) X_test = np . genfromtxt ( 'hw2-data/X_test.csv' , delimiter = ',' ) y_test = np . genfromtxt ( 'hw2-data/y_test.csv' ) def append_column_one ( data ): append_ones = np . ones (( data . shape [ 0 ], 1 )) data = np . hstack (( append_ones , data )) return data X_train = append_column_one ( X_train ) X_test = append_column_one ( X_test ) np . place ( y_train , y_train == 0 , - 1 ) np . place ( y_test , y_test == 0 , - 1 ) In [2]: def calculate_sigmoid ( x ): return expit ( x ) In [3]: def calculate_update ( X_train , y_train , weights , sigmoid_iter ): update = np . zeros ( len ( weights )) for i in range ( 0 , X_train . shape [ 0 ]): update += y_train [ i ] * ( 1 - sigmoid_iter [ i ]) * X_train [ i ] return update In [4]: def calculate_objectiveFunc ( X_train , y_train , weights ): output = 0 sigmoid_iter = [] for i in range ( 0 , X_train . shape [ 0 ]): sigmoid_value = calculate_sigmoid ( y_train [ i ] * np . dot ( X_train [ i ], weights )) sigmoid_iter . append ( sigmoid_value ) output += np . log ( sigmoid_value ) return output , sigmoid_iter In [5]: objective_value = [] w = np . zeros ( X_train . shape [ 1 ]) for t in range ( 1 , 10001 ): #print \"Iteration \", t learning_rate = 1.0 / ( np . power ( 10 , 5 ) * np . sqrt ( t + 1 )) iter_objectiveVal , sigmoid_iter = calculate_objectiveFunc ( X_train , y_train , w ) objective_value . append ( iter_objectiveVal ) #print iter_objectiveVal w = w + ( learning_rate * calculate_update ( X_train , y_train , w , sigmoid_iter )) Logistic Regression objective training function L per iteration for t = 1, 2, ..., 10000 In [6]: plt . figure ( figsize = ( 9 , 6 )) plt . plot ( objective_value ) plt . xlabel ( \"Iterations\" ) plt . ylabel ( \"Objective Training Function\" ) plt . title ( \"Logistic Regression objective training function L per iteration for t = 1, 2, ..., 10000\" ) plt . show () Logistic Regression : Newton's Method (Optimization) In [16]: import numpy as np import matplotlib.pyplot as plt import operator #import scipy from scipy.special import expit % matplotlib inline X_train = np . genfromtxt ( 'hw2-data/X_train.csv' , delimiter = ',' ) y_train = np . genfromtxt ( 'hw2-data/y_train.csv' ) X_test = np . genfromtxt ( 'hw2-data/X_test.csv' , delimiter = ',' ) y_test = np . genfromtxt ( 'hw2-data/y_test.csv' ) def append_column_one ( data ): append_ones = np . ones (( data . shape [ 0 ], 1 )) data = np . hstack (( append_ones , data )) return data X_train = append_column_one ( X_train ) #print X_train.shape X_test = append_column_one ( X_test ) np . place ( y_train , y_train == 0 , - 1 ) np . place ( y_test , y_test == 0 , - 1 ) In [17]: def calculate_deltaupdate ( X_train , y_train , weights ): update = np . zeros ( len ( weights )) for i in range ( 0 , X_train . shape [ 0 ]): update = update + y_train [ i ] * ( 1 - calculate_sigmoid ( y_train [ i ] * np . dot ( X_train [ i ], weights ))) * X_train [ i ] return update In [18]: def calc_squareinvupdate ( X_train , y_train , weights ): output_matrix = np . zeros (( len ( weights ), len ( weights ))) for i in range ( 0 , X_train . shape [ 0 ]): sig_value = calculate_sigmoid ( np . dot ( X_train [ i ], weights )) output_matrix += sig_value * ( 1 - sig_value ) * np . outer ( X_train [ i ], X_train [ i ]) return np . linalg . inv ( - output_matrix ) In [19]: def calculate_objectiveFunc ( X_train , y_train , weights ): output = 0 for i in range ( 0 , X_train . shape [ 0 ]): output += np . log ( calculate_sigmoid ( y_train [ i ] * np . dot ( X_train [ i ], weights ))) return output In [20]: objective_value = [] w = np . zeros ( X_train . shape [ 1 ]) #print len(w) for t in range ( 1 , 101 ): #print \"Iteration \", t learning_rate = 1.0 / ( np . sqrt ( t + 1 )) #print \"Objective function value \", calculate_objectiveFunc(X_train, y_train, w) objective_value . append ( calculate_objectiveFunc ( X_train , y_train , w )) w = w - ( learning_rate * np . dot ( calc_squareinvupdate ( X_train , y_train , w ), calculate_deltaupdate ( X_train , y_train , w ))) Objective Function L on training data as a function of t = 1, 2, ... , 100 In [21]: plt . figure ( figsize = ( 9 , 6 )) plt . plot ( objective_value ) plt . xlabel ( \"Iterations\" ) plt . ylabel ( \"Objective Training Function\" ) plt . title ( \"Objective Function L on training data as a function of t = 1, 2, ... , 100\" ) plt . show () In [22]: def predict_test_data ( X_test , weights ): predicted_test = [] for i in range ( 0 , len ( X_test )): output = calculate_sigmoid ( np . dot ( X_test [ i ], weights )) if output > 0.5 : predicted_test . append ( 1 ) else : predicted_test . append ( - 1 ) return predicted_test In [23]: predictions = predict_test_data ( X_test , w ) In [29]: def prediction_accuracy ( predicted_labels , original_labels ): count = 0 for i in range ( len ( predicted_labels )): if predicted_labels [ i ] == original_labels [ i ]: count += 1 #print count, len(predicted_labels) return float ( count ) / len ( predicted_labels ) In [30]: print ( \"Prediction accuracy is {} \" . format ( prediction_accuracy ( y_test , predictions ))) Prediction accuracy is 0.9139784946236559 Prediction Accuracy on testing data is 0.91397 or 91.397% if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Machine Learning","url":"blog/2017/10/01/ml-logistic/"},{"title":"Ridge Regression using numpy in Python","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Predict car mileage using car features I will implement the Linear Regression algorithm with squared penalization term in the objective function (Ridge Regression) using Numpy in Python . Further, we will apply the algorithm to predict the miles per gallon for a car using six features about that car. The data is already standardized and can be obtained here Github link . The input variables are anonymous except the 4th and 6th dimension which correspond to car weight and car year . The penalization coefficient ($\\lambda$) is varied and the feature weights are plotted against degree of freedoms for values of $\\lambda$ ranging from 0 to 5000. $\\lambda = 0 $ corresponds to Simple Linear Regression (no penalty) \\begin{equation} w_{rr} = arg \\ \\underset{w}{min}\\ \\left\\Vert y - Xw\\right\\Vert&#94;2 + \\lambda\\ \\left\\Vert w \\right\\Vert&#94;2 \\end{equation}\\begin{equation} \\begin{split} L &=\\ \\left\\Vert y - Xw \\right \\Vert&#94;2 + \\lambda \\ \\left \\Vert w \\right \\Vert &#94;2 \\\\ &=(y - Xw)&#94;{T} (y - Xw) + \\lambda w&#94;T w \\end{split} \\end{equation} To find optimum value for $ w_{rr} $, we take the gradient of $L$ and set it to zero \\begin{equation} \\nabla L_w = -2X&#94;Ty + 2X&#94;TXw + 2\\lambda w = 0 \\end{equation}\\begin{equation}\\tag{1} w_{rr} = (\\lambda I + X&#94;TX)&#94;{-1}X&#94;Ty \\end{equation} Degrees of Freedom: \\begin{equation}\\tag{2} df(\\lambda) = trace \\ [X(X&#94;TX + \\lambda I)&#94;{-1}X&#94;T] \\end{equation} In [1]: import numpy as np import matplotlib.pyplot as plt % matplotlib inline plt . rcParams [ \"figure.figsize\" ] = ( 10 , 8 ) Ridge Regression function implemented using Numpy In [1]: def SolveRidgeRegression ( X , y ): wRR_list = [] df_list = [] for i in range ( 0 , 5001 , 1 ): lam_par = i xtranspose = np . transpose ( X ) xtransx = np . dot ( xtranspose , X ) if xtransx . shape [ 0 ] != xtransx . shape [ 1 ]: raise ValueError ( 'Needs to be a square matrix for inverse' ) lamidentity = np . identity ( xtransx . shape [ 0 ]) * lam_par matinv = np . linalg . inv ( lamidentity + xtransx ) xtransy = np . dot ( xtranspose , y ) wRR = np . dot ( matinv , xtransy ) _ , S , _ = np . linalg . svd ( X ) df = np . sum ( np . square ( S ) / ( np . square ( S ) + lam_par )) wRR_list . append ( wRR ) df_list . append ( df ) return wRR_list , df_list Degree of Freedom Plots with varying hyperparameter, $\\lambda$ In [2]: def makeDFPlots ( dfArray , wRRArray ): #print wRR_array.shape, df_array.shape plt . figure () colors = [ '#e41a1c' , '#377eb8' , '#4daf4a' , '#984ea3' , '#ff7f00' , '#ffff33' , '#a65628' ] labels = [ \"Dimension 1\" , \"Dimension 2\" , \"Dimension 3\" , \"Dimension 4 (car weight)\" , \"Dimension 5\" , \"Dimension 6 (car year)\" , \"Dimension 7\" ] for i in range ( 0 , wRR_list [ 0 ] . shape [ 0 ]): plt . plot ( dfArray , wRRArray [:, i ], color = colors [ i ]) plt . scatter ( dfArray , wRRArray [:, i ], color = colors [ i ], s = 8 , label = labels [ i ]) # df(lambda) plt . xlabel ( r \"df($\\lambda$)\" ) # and a legend plt . legend ( loc = 'lower left' ) plt . show () Calling Ridge Regression on Data In [13]: X_train = np . genfromtxt ( 'hw1-data/X_train.csv' , delimiter = ',' ) y_train = np . genfromtxt ( 'hw1-data/y_train.csv' ) In [14]: X_train Out[14]: array([[ 0.30957 , -0.36707 , 0.45545 , ..., -0.73992 , -0.80885 , 1. ], [ 0.30957 , 0.3592 , -0.11611 , ..., 0.16625 , -0.80885 , 1. ], [-0.86291 , -0.99778 , -0.89551 , ..., -0.55868 , -0.26592 , 1. ], ..., [ 0.30957 , 0.53121 , -0.84355 , ..., 1.9786 , -0.26592 , 1. ], [ 0.30957 , -0.30018 , 0.74123 , ..., 0.093761, 0.54847 , 1. ], [ 1.4821 , 1.0281 , 0.63731 , ..., -0.77616 , 0.81993 , 1. ]]) In [15]: wRR_list , df_list = SolveRidgeRegression ( X_train , y_train ) wRRArray = np . asarray ( wRR_list ) dfArray = np . asarray ( df_list ) In [16]: makeDFPlots ( dfArray , wRRArray ) Inference about the above plot From the solution, we know that when the df($\\lambda$) is the maximum value, that corresponds to $\\lambda$ equal to 0, which is the least squares solution. The fourth dimension (car weight) and the sixth dimension (car year) have the highest magnitude, which indicates that they are the most important features in determining the fuel efficiency for cars. As the sixth dimension it positive, it shows that the fuel efficiency increases with the increase in car years and as the fourth dimension is negative, it shows that the fuel efficiency decreases with the increase in car weight. So, we can say that for the least squares solution, the dimensions 4 (car weight) and dimensions 6 (car year) are the most important dimensions which affect the solution, but because we always try and regularize the weights to be small, their weights get penalized the most by including the hyper parameter ($\\lambda$) for Ridge Regression and varying it. As $\\lambda$ is always greater than 0, increasing the values of $\\lambda$ leads to a decrease in the degrees of freedom and regularized weights for all the covariates in our solution. Plot RMSE values with varying hyperparameter, $\\lambda$ In [7]: X_test = np . genfromtxt ( 'hw1-data/X_test.csv' , delimiter = ',' ) y_test = np . genfromtxt ( 'hw1-data/y_test.csv' ) In [8]: def plotRMSEValue ( max_lamda , RMSE_list , poly ): colors = [ '#e41a1c' , '#377eb8' , '#4daf4a' , '#984ea3' , '#ff7f00' , '#ffff33' , '#a65628' ] legend = [ \"Polynomial Order, p = 1\" , \"Polynomial Order, p = 2\" , \"Polynomial Order, p = 3\" ] plt . plot ( xrange ( len ( RMSE_list )), RMSE_list , color = colors [ poly ]) plt . scatter ( xrange ( len ( RMSE_list )), RMSE_list , color = colors [ poly ] , s = 8 , label = legend [ poly - 1 ]) # df(lambda) plt . xlabel ( r \"$\\lambda$\" ) plt . ylabel ( \"RMSE\" ) # and a legend plt . legend ( loc = 'upper left' ) plt . title ( r \"RMSE vs $\\lambda$ values for the test set, $\\lambda$ = 0.. %d \" % ( max_lamda )) In [9]: def getRMSEValues ( X_test , y_test , wRRArray , max_lamda , poly ): RMSE_list = [] for lamda in xrange ( 0 , max_lamda + 1 ): wRRvals = wRRArray [ lamda ] y_pred = np . dot ( X_test , wRRvals ) RMSE = np . sqrt ( np . sum ( np . square ( y_test - y_pred )) / len ( y_test )) RMSE_list . append ( RMSE ) plotRMSEValue ( max_lamda , RMSE_list , poly = poly ) In [10]: plt . figure () getRMSEValues ( X_test , y_test , wRRArray , max_lamda = 50 , poly = 1 ) plt . show () From the figure, we can understand that the least RMSE value is obtained for $\\lambda$ = 0 and as the value of $\\lambda$ increase, the RMSE increases. Also, as $\\lambda$ = 0 is the least squares solution, which gives the least RMSE value, for this particular problem, using just the polynomial order 1 covariates, we should use the least squares solution, i.e., $\\lambda$ = 0 instead of using Ridge Regression (where $\\lambda$ > 0). Ridge Regression with Polynomial Features In [11]: def addPolynomialOrder ( input_matrix , p ): if p == 1 : return input_matrix elif p == 2 : a = input_matrix b = np . power ( input_matrix [:, 0 : 6 ], 2 ) out = np . hstack (( a , b )) return out elif p == 3 : a = input_matrix b = np . power ( input_matrix [:, 0 : 6 ], 2 ) c = np . power ( input_matrix [:, 0 : 6 ], 3 ) out = np . hstack (( a , b , c )) return out In [12]: ## Set xlimits for the graphs plt . figure () for i in [ 1 , 2 , 3 ]: X_train_appended = addPolynomialOrder ( X_train , p = i ) X_test_appended = addPolynomialOrder ( X_test , p = i ) wRR_list , df_list = SolveRidgeRegression ( X_train_appended , y_train ) wRRArray = np . asarray ( wRR_list ) dfArray = np . asarray ( df_list ) getRMSEValues ( X_test_appended , y_test , wRRArray , max_lamda = 500 , poly = i ) plt . show () Inference of above plot : RMSE values with varying hyperparameters for different polynomial order features Looking at the curves, we should choose the polynomial order p = 2, as it results in the lowest RMSE value for a particular value of $\\lambda$ at 21. Also at p = 3, we get nearly the same lowest RMSE value at $\\lambda$ = 23, but we should choose the simpler model obtained using p = 2. We can say that when p = 1, it produces a simpler model that underfits the data. When p = 2 or p = 3, at lower values of $\\lambda$, the model fits the data better (might also overfit) and gives the least RMSE values and can be chosen. We see that on further increasing the $\\lambda$ values for higher order's of p, we still underfit the data with an increase in the RMSE values. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Machine Learning","url":"blog/2017/09/30/ml-regression/"},{"title":"R in Python (Using R ggplot to make visualizations in Jupyter Notebook)","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } I have been using Python as my daily tool and got a chance to work with R during my Spring 2017 semester at Columbia University. I appreciate R for its statistical tools and amazing visualization libraries like ggplot . For the final project, I wanted to use Python again but also wanted to use R visualization tools. My online search led me to a python package called rpy2 and I will show how we can use it to integrate R in Jupyter Notebooks via Cell Magics . My preferred way to set up Python Environments In the past I liked using virtualenv and virtualenvwrapper, but have recently shifted to using Conda and use it everyday in my workflow. A general walkthrough follows : Create the virtual environment conda create -n py_R python=3.6 Install the pre-requistie packages conda install rpy2 conda install jupyter conda install pandas Imports for the Code In [1]: ## Lets try out some code import pandas as pd # do all processing in pandas, and convert Pandas DataFrame to R DataFrame ## imports required from rpy2 from rpy2.robjects import pandas2ri pandas2ri . activate () % reload_ext rpy2.ipython In [2]: ## HTML changes to align the images to the center of the screen from IPython.core.display import HTML HTML ( \"\"\" </span> <span class=\"s2\">.output_png {</span> <span class=\"s2\"> display: table-cell;</span> <span class=\"s2\"> text-align: center;</span> <span class=\"s2\"> vertical-align: middle;</span> <span class=\"s2\"> }</span> <span class=\"s2\"> \"\"\" ) Out[2]: .output_png { display: table-cell; text-align: center; vertical-align: middle; } Pandas DataFrame : Just initialize a data frame In [9]: df = pd . DataFrame ({ 'Letter' : [ 'a' , 'a' , 'a' , 'b' , 'b' , 'b' , 'c' , 'c' , 'c' ], 'X' : [ 4 , 3 , 5 , 2 , 1 , 7 , 7 , 5 , 9 ], 'Y' : [ 0 , 4 , 3 , 6 , 7 , 10 , 11 , 9 , 13 ], 'Z' : [ 1 , 2 , 3 , 1 , 2 , 3 , 1 , 2 , 3 ]}) In [10]: df Out[10]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } Letter X Y Z 0 a 4 0 1 1 a 3 4 2 2 a 5 3 3 3 b 2 6 1 4 b 1 7 2 5 b 7 10 3 6 c 7 11 1 7 c 5 9 2 8 c 9 13 3 Using rpy2 is as simple as using cell magic R You can also specify the input pandas dataframe to R cell using %%R with -i with the height and width specified after -w and -h arguments and the units specified using the -u argument In [12]: %% R - i df - w 900 - h 480 - u px ## Everything in here is ** R ** (magic) print ( df ) # Tada, df is now an R dataframe library ( \"ggplot2\" ) # If this line does not work, make sure you have R installed on your laptop ggplot ( data = df ) + geom_point ( aes ( x = X , y = Y , color = Letter , size = Z )) Letter X Y Z 0 a 4 0 1 1 a 3 4 2 2 a 5 3 3 3 b 2 6 1 4 b 1 7 2 5 b 7 10 3 6 c 7 11 1 7 c 5 9 2 8 c 9 13 3 if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Data_Viz","url":"blog/2017/09/30/r-python/"},{"title":"Quantified Self : Analyzing Personal Garmin Data (2012-2017)","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } I. Introduction Insights into my fitness journey (2012 - 17) I have been an avid runner and fitness enthusiast for the past 5 years, and what has been a fun part of all those is how much we can learn about ourselves from exploring the data we capture. I started capturing data about myself around the year 2012, which was when we saw the advent of wearable devices, and have always wanted to carry out an analysis to gain insights about my running patterns, my strength training schedules, my diet logs and any other metadata which I can collect about myself like the Heart Rate, Cadence for runs and also the step counts. About Quantified Self : When learning about the ways to explore about the data you capture, I came across the term Quantified Self and have been following the blog ever since. Its just amazing how capturing and analyzing data about yourself can actually help me make data driven decision to improve your lifestyle and so many people are joining this movement and bringing a data-driven change to improve their lives. Questions which I would like to answer in my project analysis are as follows : How much time have I spent on various activities like Running, Treadmill Running, Strength Training Sessions, Cycling and Cardio Sessions? What is a count of the activities and how do they vary across specific months over the span of 5 years? Activity Day Analysis : What has been the most active day in the week and the distribution of activities across specific days of a week Calorie Analysis : An analysis of the distribution of calories burnt during activities, along with the distribution of calories burnt during specific activities and detecting outliers (which I am happy about) How many calories have I burnt in total for every activity and see any trends for the activities across the years 2012-2017? Interactive Plot using D3.js What is the hour of the day that I usually do the activities and how has it changed over the past 5 years? It will help me relive the changes that have happened in my life and how they have affected my schedules. Interactive Plot using D3.js Analyzing the trend of how the Activity minutes vary across the months for years 2012-2016. Interactive D3.js visualization Analyzing the trend of how my running mileage varies across the months for the year data 2012-2016. Interactive Plot using D3.js Analysis of the total minutes spent on each activity type during the months in year 2012-17 Analyzing average calories burnt for every activity type during the months of years 2012-17 Analyzing average heart rate based activity levels and its variation along the aggregated days of the week and aggregated activity types I do take inspiration from the Quantified Self Running archives and will try and do an analysis on all these aspects about my data. Where the reader can find the data? I would like to share the data captured about all my activities if someone wants to analyze it. The data used for this project is hosted on Github at this link . This code file has also been hosted on Github and can be accessed at this link . You can always mail me to get the most updated data at anujk3@gmail.com . II. Team I will be working by myself on my dataset and gaining insights through the analysis I do. The stages of the project have been highlighted below: I had to go to the activities page on Garmin and download around 22 pages of data one by one which had all the data in a csv format. Sadly, Garmin does not offer an API like fitbit which makes it difficult to gather any data for analysis. After getting the data from Garmin, the next part was combining all the csv files together and converting it into a dataframe which can be analyzed further. All the processing was done in python using pandas. The initial processing involved cleaning the data, remove extraneous activities like walking, swimming etc. which I haven't tracked a lot, correcting the data errors, correcting datetime fields for the ease of datetime analysis. After initial cleaning of data, I was focussed on data transformations to add dervied columns to the data which can be useful to exploratory data analysis. The next part was focussed on doing an analysis of missing values followed by the existing continuous and discrete variables in the dataset which involed an analysis of the missing values along with an analysis of important univariate distributions of continuous columns and multivariate analysis of continuous variables. The next part was to figure out the important questions which I can answer using the dataset and work on specific problems to come with relevant visualizations for explaning them. Programming Language Used : Something I am really passionate about is doing data analysis work and Python has been my go to language for it. Through the course Exploratory Data Analysis and Visualizations, Prof. Joyce Robbins did help me realize how even R can help in quickly analyzing the data and actually the best part about R for me was getting to learn about ggplot . I still prefer using Python as my language for data analysis but hacked my way to use ggplot within the Python Analysis and will be doing most of my dataframe analysis in Python and making plots with ggplot , but all within a Python Notebook . I will also be working on interactive visualizations using D3.js and whenever possible matplotlib within Python along with seaborn . III. Analysis of Data Quality i. Import Statements and Setup In [1]: import pandas as pd import math import warnings import numpy as np from rpy2.robjects import pandas2ri pandas2ri . activate () warnings . filterwarnings ( 'ignore' ) import matplotlib.pyplot as plt import seaborn as sns plt . rcParams [ \"figure.figsize\" ] = ( 20 , 20 ) % reload_ext rpy2.ipython % matplotlib inline pd . options . display . max_rows = 999 sns . set_style ( \"white\" ) In [1]: from IPython.core.display import HTML HTML ( \"\"\" </span> <span class=\"s2\">.output_png {</span> <span class=\"s2\"> display: table-cell;</span> <span class=\"s2\"> text-align: center;</span> <span class=\"s2\"> vertical-align: middle;</span> <span class=\"s2\"> }</span> <span class=\"s2\"> \"\"\" ) Out[1]: .output_png { display: table-cell; text-align: center; vertical-align: middle; } ii. Load Data In [3]: path = \"data/a\" frame = pd . DataFrame () list_ = [] for i in range ( 1 , 27 ): file_path = path + str ( i ) + \".csv\" #print(file_path) df = pd . read_csv ( file_path , index_col = None , header = 0 , skiprows = 2 ) list_ . append ( df ) frame = pd . concat ( list_ ) frame . reset_index ( inplace = True ) frame . drop ( \"index\" , axis = 1 , inplace = True ) frame . drop ( \" Favorite\" , axis = 1 , inplace = True ) frame . drop ( \"Unnamed: 11\" , axis = 1 , inplace = True ) In [4]: #frame.columns In [5]: col_names = [ 'activityType' , 'startTime' , 'activityTime' , 'actDistance' , 'elevationGain' , 'avgSpeed' , 'avgHR' , 'maxHR' , 'steps' , 'calories' ] frame . columns = col_names iii. Data Cleaning Data Cleaning has been performed in the following steps to ease the process for creating the visualizations later. Ignore the swimming activity, only 1 row In [6]: frame . drop ( 450 , axis = 0 , inplace = True ) Convert Elliptical to Cardio In [7]: frame [ frame [ \"activityType\" ] == \"Elliptical\" ] frame . loc [ 384 , \"activityType\" ] = \"Cardio\" Ignore Walking as an activity In [8]: frame . drop ( frame [ frame [ \"activityType\" ] == \"Walking\" ] . index , axis = 0 , inplace = True ) Ignore swimming as an activity as only 3 recorded activities In [9]: frame [ frame [ \"activityType\" ] == \"Lap Swimming\" ] . index frame . drop ( frame [ frame [ \"activityType\" ] == \"Lap Swimming\" ] . index , axis = 0 , inplace = True ) Activity type Strength Training was recording as Others in older Garmin Devices In [10]: frame . drop ([ 214 , 221 , 223 , 242 ], axis = 0 , inplace = True ) frame . activityType = frame . activityType . str . replace ( \"Other\" , \"Strength Training\" ) Activity Types Indoor Rowing and Indoor Cycling also included as Cardio In [11]: frame . activityType = frame . activityType . str . replace ( \"Indoor Rowing\" , \"Cardio\" ) frame . activityType = frame . activityType . str . replace ( \"Indoor Cycling\" , \"Cardio\" ) Correcting Data Errors and Data Types In [12]: frame . loc [ frame [ \"activityType\" ] == \"Strength Training\" , \"actDistance\" ] = np . NaN frame . loc [ frame [ \"activityType\" ] == \"Strength Training\" , \"elevationGain\" ] = np . NaN frame . loc [ frame [ \"activityType\" ] == \"Strength Training\" , \"avgSpeed\" ] = np . NaN frame . loc [ frame [ \"activityType\" ] == \"Strength Training\" , \"steps\" ] = np . NaN frame . loc [ frame [ \"activityType\" ] == \"Cardio\" , \"actDistance\" ] = np . NaN frame . loc [ frame [ \"activityType\" ] == \"Cardio\" , \"elevationGain\" ] = np . NaN frame . loc [ frame [ \"activityType\" ] == \"Cardio\" , \"avgSpeed\" ] = np . NaN frame . loc [ frame [ \"activityType\" ] == \"Cardio\" , \"steps\" ] = np . NaN In [13]: frame [ \"avgHR\" ] = frame [ \"avgHR\" ] . replace ([ '--' , '0' ], np . NaN ) frame [ \"maxHR\" ] = frame [ \"maxHR\" ] . replace ([ '--' , '0' ], np . NaN ) frame [ \"steps\" ] = frame [ \"steps\" ] . replace ([ '--' , '0' ], np . NaN ) frame [ \"steps\" ] = frame . steps . str . replace ( \",\" , \"\" ) frame [ 'avgHR' ] = frame . avgHR . astype ( float ) frame [ 'maxHR' ] = frame . maxHR . astype ( float ) frame [ 'steps' ] = frame . steps . astype ( float ) In [14]: frame [ \"elevationGain\" ] = frame [ \"elevationGain\" ] . replace ([ '--' , '0' , 0 ], np . NaN ) frame . loc [[ 456 , 495 ], \"elevationGain\" ] = 328 frame [ \"elevationGain\" ] = frame . elevationGain . str . replace ( \",\" , \"\" ) frame [ 'elevationGain' ] = frame . elevationGain . astype ( float ) frame [ \"avgSpeed\" ] = frame . avgSpeed . str . replace ( \":\" , \".\" ) frame [ \"avgSpeed\" ] = frame . avgSpeed . str . replace ( \"--.--\" , '0.0' ) frame [ 'avgSpeed' ] = frame . avgSpeed . astype ( float ) frame [ 'actDistance' ] = frame . actDistance . astype ( float ) frame [ \"calories\" ] = frame . calories . apply ( lambda x : str ( x ) . replace ( \",\" , \"\" )) frame [ 'calories' ] = frame . calories . astype ( float ) In [15]: frame . drop ( frame [ frame [ \"actDistance\" ] < 0.01 ] . index , axis = 0 , inplace = True ) frame . reset_index ( inplace = True ) frame . drop ( \"index\" , axis = 1 , inplace = True ) In [16]: running_data = frame . copy () running_data . to_csv ( \"vis1.csv\" ) iv. Exploring the data and the datatypes Initial Peek into the data In [17]: running_data . head () Out[17]: activityType startTime activityTime actDistance elevationGain avgSpeed avgHR maxHR steps calories 0 Strength Training Thu, 6 Apr 2017 10:43 PM 1:09:02 NaN NaN NaN 119.0 163.0 NaN 597.0 1 Strength Training Tue, 4 Apr 2017 10:36 PM 54:37 NaN NaN NaN 117.0 155.0 NaN 474.0 2 Strength Training Sun, 2 Apr 2017 10:46 PM 1:12:20 NaN NaN NaN 116.0 159.0 NaN 601.0 3 Strength Training Tue, 28 Mar 2017 11:02 PM 42:11 NaN NaN NaN 99.0 142.0 NaN 257.0 4 Strength Training Mon, 27 Mar 2017 11:17 PM 45:42 NaN NaN NaN 120.0 165.0 NaN 412.0 v. Data Transformations Creating Derived Fields that can be used for the visualizations. The transformations have been highlighted. Converting startTime to Python DateTime Format to use the inbuilt functions In [18]: running_data [ \"startTime\" ] = pd . to_datetime ( running_data [ \"startTime\" ]) #running_data.head() Concatenating information about the Month and Year for every activity to the DataFrame In [19]: running_data [ \"activityMonth\" ] = running_data . startTime . dt . month running_data [ \"activityDay\" ] = running_data . startTime . dt . dayofweek In [20]: running_data [ \"activityMonthName\" ] = running_data . activityMonth . map ({ 1 : \"January\" , 2 : \"February\" , 3 : \"March\" , 4 : \"April\" , 5 : \"May\" , 6 : \"June\" , 7 : \"July\" , 8 : \"August\" , 9 : \"September\" , 10 : \"October\" , 11 : \"November\" , 12 : \"December\" }) In [21]: running_data [ \"activityDayName\" ] = running_data . activityDay . map ({ 0 : \"Monday\" , 1 : \"Tuesday\" , 2 : \"Wednesday\" , 3 : \"Thursday\" , 4 : \"Friday\" , 5 : \"Saturday\" , 6 : \"Sunday\" }) Obtaining Activitiy Levels using the average HR field for all the workouts In [22]: ## To-Do : Divide the Heart Rate Zones from the data into Zones and create a new column # < 114 - Very Light # 114-133 - Light # 133-152 - Moderate # 152-171 - Hard # >171 - Very Hard ## do using lambda: apply a function def get_hr_zones ( avgHR ): if math . isnan ( avgHR ): return \"Not Recorded\" if avgHR < 114 : return \"Very Light\" elif avgHR >= 114 and avgHR < 133 : return \"Light\" elif avgHR >= 133 and avgHR < 152 : return \"Moderate\" elif avgHR >= 152 and avgHR < 171 : return \"Hard\" else : return \"Very Hard\" In [23]: running_data [ \"activityLevel\" ] = running_data . avgHR . apply ( get_hr_zones ) Calculating total minutes of an activity from the data In [24]: def getMinutes ( activityTime ): curr_time = activityTime . split ( \":\" ) if len ( curr_time ) == 2 : final_time = curr_time [ 0 ] + \".\" + curr_time [ 1 ] else : # print curr_time mins = int ( curr_time [ 0 ]) * 60 + int ( curr_time [ 1 ]) final_time = str ( mins ) + \".\" + curr_time [ 2 ] return final_time In [25]: running_data [ \"activityMins\" ] = running_data . activityTime . apply ( getMinutes ) running_data [ \"activityMins\" ] = running_data [ \"activityMins\" ] . astype ( \"float\" ) In [26]: running_data . drop ( \"activityTime\" , axis = 1 , inplace = True ) #running_data.head() In [27]: #running_data.head() running_data . to_csv ( \"vis2.csv\" ) Checking final data types In [28]: running_data . dtypes Out[28]: activityType object startTime datetime64[ns] actDistance float64 elevationGain float64 avgSpeed float64 avgHR float64 maxHR float64 steps float64 calories float64 activityMonth int64 activityDay int64 activityMonthName object activityDayName object activityLevel object activityMins float64 dtype: object Creating a list of continuous and categorical variable In [29]: categorical_vars = running_data . describe ( include = [ \"object\" ]) . columns continuous_vars = running_data . describe () . columns vi. Summary of Continuous Variables and Missing Data Analysis The summary of continuous variables helps us figure out the count of values for all the variables where the values are present. It helps us explore the number of missing values for the variables and begin the analysis of MISSING DATA In [30]: running_data . describe () Out[30]: actDistance elevationGain avgSpeed avgHR maxHR steps calories activityMonth activityDay activityMins count 211.000000 80.000000 211.000000 336.000000 336.000000 82.000000 494.000000 494.000000 494.000000 494.000000 mean 5.018436 208.725000 9.970711 123.291667 157.639881 8519.463415 585.524291 6.447368 3.192308 63.260020 std 4.160373 284.234659 3.127073 17.777179 14.814820 8494.509896 455.932193 3.712304 2.070135 42.252763 min 0.240000 3.000000 0.000000 77.000000 81.000000 404.000000 0.000000 1.000000 0.000000 1.270000 25% 2.470000 51.500000 8.580000 111.000000 150.000000 3783.500000 244.500000 3.000000 1.000000 28.437500 50% 3.550000 112.500000 9.470000 121.000000 159.000000 4753.000000 482.500000 7.000000 3.000000 58.560000 75% 6.300000 257.500000 11.005000 135.000000 168.000000 9205.000000 816.500000 10.000000 5.000000 91.367500 max 26.340000 1943.000000 43.370000 168.000000 188.000000 42808.000000 3362.000000 12.000000 6.000000 280.590000 Looking at the count of values for all the continuous variables, we observe that out of 494 activities, 211 activities had distance recorded, 80 activities had elevationGains recorded, the average speed was recorded for 211 activities, with average and max Heart Rate being recorded for 336 activities. Calories, Activity Month, Activity Day and the Activity Minutes were recorded for all the activities Some of the reasons for missing data are as follows : During the span of 5 years, I have changed 4 wearable devices. Initially I used the Garmin Vivofit tracker for all the runs, which did not have heart rate tracker. After that I bought the Garmin Forerunner 920 (GPS inbuilt), which had a heart rate strap along with it and it also used to calculate the elevationGain and many more parameters for all the runs. But I do realize that I was lazy to use the heart rate strap as it needed to be washed after every run. After that I used the Garmin Vivofit2 tracker, which had inbuilt heart rate monitor but lacked GPS, so the runs were still being tracked by Garmin Forerunner 920 and whenever were tracked using Vivofit2, lacked heart rate information. Currently I am using the Garmin Vivoactive HR, which has an wrist HR monitor as well as an inbuilt GPS, but being in Graduate School, the frequency of runs has gone down significantly. All the variables in the analysis are important but lets do an initial missing data analysis with visualizations Visualization : Missing Data 1 In [31]: running_data_continuous = running_data [ running_data . describe () . columns ] . copy () In [32]: %% R - i running_data_continuous - w 900 - h 480 - u px library ( vcd ) library ( dplyr ) library ( readr ) library ( grid ) # for gpar library ( RColorBrewer ) library ( scales ) library ( knitr ) library ( mi ) image ( missing_data.frame ( running_data_continuous )) rm ( list = ls ()) NOTE: The following pairs of variables appear to have the same missingness pattern. Please verify whether they are in fact logically distinct variables. [,1] [,2] [1,] \"avgHR\" \"maxHR\" Visualization : Missing Data 2 In [33]: %% R - i running_data_continuous - w 900 - h 480 - u px library ( vcd ) library ( dplyr ) library ( grid ) # for gpar library ( RColorBrewer ) library ( \"VIM\" ) library ( \"mice\" ) library ( lattice ) aggr_plot <- aggr ( running_data_continuous , col = c ( 'skyblue' , 'red' ), numbers = TRUE , sortVars = TRUE , labels = names ( running_data_continuous ), cex.axis = .7 , gap = 3 , ylab = c ( \"Heatmap of missing data\" ), combined = TRUE ) rm ( list = ls ()) Variables sorted by number of missings: Variable Count elevationGain 414 steps 412 actDistance 283 avgSpeed 283 avgHR 158 maxHR 158 calories 0 activityMonth 0 activityDay 0 activityMins 0 Looking at the above visualization, the following patterns emerge: Average Heart Rate and Maximum Heart Rate values are missing for those specific Activities where I was using a fitness tracker which did not have Heart Rate Tracking ability. The statistics like Elevation Gain were tracked when I was using a heart rate strap attached, which being lazy I didn't use often, leading to the highest number of missing values, because of which we will not consider it as an important feature in our analysis. For the first generation fitness tracker used like Garmin Vivofit 1 and 2, even though it had capabilities to record my Running Distance based on the number of steps take, it still did not process the other metrics like Average Speed and Heart rate values. Also, the Running Distance values are missing for all workouts which involved Strength Training. If there was some recorded value for this field during Strength Training sessions due to the number of steps taken, it has been ignored and replaced with NaNs in my analysis. Steps were recorded by the most recent fitness trackers used and therefore have a lot of missing values. During activities not involving Running, the Steps have not been considered and replaced with NaNs. From the above analysis, it can be seen that the most important features for further analysis are Activity Minutes , Activity Month , Activity Day , Calories Burnt , Average Heart Rate , Maximum Heart Rate , Activity Distance Covered . The other features, specifically, Average Speed , Steps and Elevation Gain have a higher number of missing values and will not be considered important for future analysis, even though Average Speed and Steps can help me analyze the runs and find some correlations. Visualizing Distribution of Continuous Variables In [34]: _ = running_data . hist ( column = continuous_vars , figsize = ( 16 , 16 )) vi. Visualizing Distribution of Categorical Variables In [35]: print ( categorical_vars ) Index(['activityType', 'activityMonthName', 'activityDayName', 'activityLevel'], dtype='object') In [36]: # Count plots of categorical variables fig , axes = plt . subplots ( 4 , 3 , figsize = ( 16 , 16 )) plt . subplots_adjust ( left = None , bottom = None , right = None , top = None , wspace = 0.7 , hspace = 0.3 ) for i , ax in enumerate ( axes . ravel ()): if i > 3 : ax . set_visible ( False ) continue sns . countplot ( y = categorical_vars [ i ], data = running_data , ax = ax ) vii. Multivariate Distributions for Continuous Data In [37]: _ = pd . scatter_matrix ( running_data , alpha = 0.2 , figsize = ( 30 , 30 )) Analysis of the above visualization: A Scatterplot matrices is a great way to roughly determine if you have a linear correlation between multiple variables. This is particularly helpful in pinpointing specific variables that might have similar correlations amongst the dataset. Some observations are as follows: Calories burnt show approximately linear correlation with the minutes of a particular activity and the steps taken. Heteroskedasticity is observed for variables calories with activity Minutes and also activityMins and elevationGain. IV. Executive Summary I have been an avid runner and fitness enthusiast for the past 5 years, and have been capturing data about my training activities. One of the main motivations to do this analysis was to gain insights into my running patterns, my strength training schedules and any relevant information I can collect using all the data I have collected from my training sessions. During the span of five years, I have changed 4 wearable devices. Initially I used the Garmin Vivofit tracker for all the runs, which did not have heart rate tracker. After that I used the Garmin Forerunner 920 (GPS inbuilt), which had a heart rate strap along with it and it also used to calculate the elevationGain and many more parameters for all the runs. The third tracker used was the Garmin Vivofit2 tracker, which had inbuilt heart rate monitor but lacked GPS, so the runs were still being tracked by Garmin Forerunner 920 and whenever were tracked using Vivofit2, lacked heart rate information. Currently I am using the Garmin Vivoactive HR, which has an wrist HR monitor as well as an inbuilt GPS. In the summary, I will highlight the following main insights from the analysis: Hour of the day I perform the activities and how it has varied in the last 5 years? For every month of the past 5 years, how has the total activity time varied? Also, for the last 5 years, how has the running mileage varied and its comparison to the activity times? For the analysis about the hour of the day I have performed the activities, I created the following interactive visualization using D3.js: Visualization Link (Inspired by learning from the course Storytelling with Data ) Code In [ ]: HTML ( ' ' ) About the Visualization : In this specific visualization created using D3.js, the activities have been plotted as a scatter plot in increasing order of time range from 2012 to 2017. Knowing that the activities span a range of 5 years, I made the decision to not keep tick labels for x-axis but added a Data Range Slider below the x-axis to add interactivity to the plot (a date range can be chosen). The y-axis shows the time of the day (0-24 hours) and the activities are plotted as points on the graph. Also interactive buttons can be used to select any activity, like running, cycling etc. and only its patterns can be observed for a given date range. The main insights that can be obtained from the visualization are as follows: Most of the activity sessions for the past 5 years have been in the evening, which clearly show that I am not really a morning person. Most of the morning sessions included running, which were the practice runs while training for marathons. Since moving to New York in August 2016, the rightmost part of the graph, I have mostly been doing the strength sessions late night at around 22:00 hour and some really late night cycle rides along the riverside, which can be clearly seen in the visualization. The increase in the cycling sessions after moving to New York can be attributed to the annual Citibike membership and daily usage of it during the Winter vacations after Fall 2016 semester. The fitness tracking journey started with mostly tracking the runs (leftmost part of the chart consist mostly of green dots) and slowly with the improved fitness trackers bought, I started capturing more data about varied activities I did. And looking at this visualization, I also realize that in the recent times, I have been missing the feel good factor after my long runs, and need to get back to running soon. It is clearly visible that I have mostly been focusing on the strength training sessions (rightmost pink clusters) in the recent times. To understand the total activity time and how it varied for the last 5 years during specific months, I created the following D3 visualization : Visualization Link (Inspired by learning from the course Storytelling with Data ) Code In [ ]: HTML ( ' ' ) About the visualization : In this specific visualization created using D3.js, the total aggregated minutes of the activity types have been plotted on the y-axis with its variation across the months for the years 2012-2016. The trend line plots have been specifically annotated for every year in the analysis. Hovering the mouse on the visualization highlights the closest data points and annotates it in the visualization with the minutes spent in that month. For this visualization, I am using curved lines which help us better understand the underlying variations in the data. The main insights that can be obtained from the visualization are as follows: The tracking for the workout sessions began in 2012, with about 200 minutes of activity captured during the month of October 2012, but I was still not much into tracking at that time. During the year 2013, I started tracking my running activities only and most of the activity minutes for the months in 2013 are due to the runs that have been tracked. During the year 2014, I started my running journey and joined the Gurgaon Road Runners group and got inspired to track my runs more seriously. Even though I was still only capturing my runs for the year, I had a decent running time during most of the months from March - May. The time spent on running activities reduced because of extreme hot temperatures in India during June and July and then the I started training for a half marathon, due to which the activity minutes picked up during the end months of 2014. During the year 2015, I just ran a half marathon for the month of January and after that had a cool down period. Because of the advanced fitness trackers bought during 2015, from June I started capturing my strength training sessions along with the running sessions and along with it, I started preparing for a half marathon in December and full marathon in January, because of which there has been a high value of activity minutes recorded for the last half of 2015 season. For the year 2016, I was running regularly and also training regularly for improving my runs in the gym, because of which there has been such high activity recorded for the year 2016. I also ran my first full marathon in January 2016 and therefore have high activity recorded for the month of January 2016. The reduction in activity minutes as 2016 progressed can be aided to the joining of Graduate school in NY and recording mostly my strength training sessions. Even though the activity minutes reduced as the year 2016 progressed, I was still capturing all my other training sessions than running and do have decent activity minutes captured. The difference of how graduate school really impacted my running schedule will be clearly visible from the following visualization of just the running kilometers tracked for the years 2014-2016. And, finally lets look at the running kilometers tracked for every month in the years 2014-2016. The result is shown in the following visualization created using D3.js : Visualization Link (Inspired by learning from the course Storytelling with Data ) Code In [ ]: HTML ( ' ' ) About the visualization : In this specific visualization created using D3.js, the running mileage has been plotted for every month of the years 2014-2016 with the running mileage on the y-axis and the months on the x-axis. I am only showing the data for these years as I was mostly capturing all my running activities during these years. The trend line plots have been specifically annotated for every year in the analysis. Hovering the mouse on the visualization highlights the closest data points and annotates it in the visualization with the total kilometers run in that month. For this visualization, I am using curved lines which help us better understand the underlying variations in the data. The main insights that can be obtained from the visualization are as follows: For the year 2014, the running time has mostly varied with the running season in India. The running season starts around August and finishes with the Delhi Marathon and Mumbai Marathon in Decemeber and January respectively, showing higher kilometers run during those times of the year. For the year 2015, after the Mumbai Marathon in January is when you rest and condition your body for the next running season. Even though in the previous plot I see that the recorded activity time is very high for the months in 2015, the actual running miles is less till the beginning of the running season in August-September. As I was preparing for my first full marathon in January 2016, the higher kilometer runs for the month of November and December 2015 are the due to the practice long runs for its preparation. For the year 2016, the running kilometers are high for the year January when I was doing the practice runs and also ran my first full marathon. After that, I was just running about a long run once a week to keep conditioning along with the rest time after the season. In July-August 2016, I was preparing and moved to NY to join graduate school and during the initial months of moving to NY, I was still logging those kilometers due to the vicinity of Central Park near my house and favorable weather conditions but as the semester proceeded and the workload increased along with extreme temperature, the running kilometers reduced significantly to even less than 10km, which is really insignificant when compared to the previous years peak running months, i.e., November and Decemeber. But I hope to be back to running soon, and doing this analysis just made me realize how important running is for my happiness. We will now proceed to the section where we will try and obtain more trends from the data, analyze the distributions of important variables in the dataset and obtain learning by analyzing all the created visualizations from the data. V. Main Data Analysis and Visualizations In this section, we will analyze the identified important features through our data quality analysis, namely, Activity Minutes , Activity Month , Activity Day and Calories Burnt . i. Analysis of the feature - Activity Minutes a. Distribution Histogram with overlayed Density Plots, with varying binwidths also In [41]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) g1 <- ggplot ( running_data , aes ( x = activityMins )) + geom_histogram ( aes ( y = .. count.. ), # Histogram with density instead of count on y-axis binwidth = 1 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. count.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Count\" ) + xlab ( \"Activity Minutes\" ) + ggtitle ( \"Activity Minutes overlayed with density estimate : Binwidth 1\" ) g1 In [42]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) multiplot <- function ( ... , plotlist = NULL , file , cols = 1 , layout = NULL ) { library ( grid ) # Make a list from the ... arguments and plotlist plots <- c ( list ( ... ), plotlist ) numPlots = length ( plots ) # If layout is NULL, then use 'cols' to determine layout if ( is.null ( layout )) { # Make the panel # ncol: Number of columns of plots # nrow: Number of rows needed, calculated from # of cols layout <- matrix ( seq ( 1 , cols * ceiling ( numPlots / cols )), ncol = cols , nrow = ceiling ( numPlots / cols )) } if ( numPlots == 1 ) { print ( plots [[ 1 ]]) } else { # Set up the page grid.newpage () pushViewport ( viewport ( layout = grid.layout ( nrow ( layout ), ncol ( layout )))) # Make each plot, in the correct location for ( i in 1 : numPlots ) { # Get the i,j matrix positions of the regions that contain this subplot matchidx <- as.data.frame ( which ( layout == i , arr.ind = TRUE )) print ( plots [[ i ]], vp = viewport ( layout.pos.row = matchidx $ row , layout.pos.col = matchidx $ col )) } } } g1 <- ggplot ( running_data , aes ( x = activityMins )) + geom_histogram ( aes ( y = .. count.. ), # Histogram with density instead of count on y-axis binwidth = 1 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. count.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Count\" ) + xlab ( \"Activity Minutes\" ) + ggtitle ( \"Activity Minutes overlayed with density estimate : Binwidth 1\" ) g2 <- ggplot ( running_data , aes ( x = activityMins )) + geom_histogram ( aes ( y = .. count.. ), # Histogram with density instead of count on y-axis binwidth = 2 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. count.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Count\" ) + xlab ( \"Activity Minutes\" ) + ggtitle ( \"Activity Minutes overlayed with density estimate : Binwidth 2\" ) g3 <- ggplot ( running_data , aes ( x = activityMins )) + geom_histogram ( aes ( y = .. count.. ), # Histogram with density instead of count on y-axis binwidth = 4 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. count.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Count\" ) + xlab ( \"Activity Minutes\" ) + ggtitle ( \"Activity Minutes overlayed with density estimate : Binwidth 4\" ) g4 <- ggplot ( running_data , aes ( x = activityMins )) + geom_histogram ( aes ( y = .. count.. ), # Histogram with density instead of count on y-axis binwidth = 6 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. count.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Count\" ) + xlab ( \"Activity Minutes\" ) + ggtitle ( \"Activity Minutes overlayed with density estimate : Binwidth 6\" ) multiplot ( g1 , g2 , g3 , g4 , cols = 2 ) Analysis of the above visualization: In the plot above, we see a distribution of Activity Minutes on the x-axis along with the count of those activities on the y-axis. The Distribution is clearly multi-modal skewed towards the right. Varying the binwidths also led to similar distributions showing the underlying pattern of the distribution. Reasons for skewness include the practice runs while I was training for my first full Marathon in 2016, the full marathon and also instances when I forgot to stop the timer while recording activities. Activity Minutes data obtained was mostly clean, except for instances when I forgot to turn of the fitness tracker resulting into longer workouts, but they were cleaned during the data cleaning process. b. Distribution of Activity Minutes across various Activities In [43]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) require ( \"viridis\" ) g1 <- ggplot ( running_data , aes ( x = activityMins , fill = activityType )) + geom_density ( alpha = 0.5 , adjust = 1 , na.rm = TRUE ) + # Overlay with transparent density plot ylab ( \"Density\" ) + xlab ( \"Activity Minutes\" ) + scale_fill_viridis ( discrete = TRUE ) + ggtitle ( \"Distribution of Activity Minutes for the different Activity Types\" ) g1 Analysis of the above visualization: In the plot above, we see a distribution of Activity Minutes on the x-axis along with the density of those activities on the y-axis for all the activity Types. The Distributions are nearly normal or skewed towards the right, which is a nice observation and helps me understand the usual minutes I spend doing a particular activity type. c. Analysis of Outliers : Activity Minutes for the activities In [44]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) fill <- \"#4271AE\" line <- \"#1F3552\" ggplot ( running_data , aes ( x = factor ( 1 ), y = activityMins )) + geom_boxplot ( fill = fill , colour = line , notch = TRUE , width = 0.2 ) + guides ( fill = FALSE ) + coord_flip () + theme ( axis.title.y = element_blank (), axis.text.y = element_blank (), axis.ticks.y = element_blank ()) + ggtitle ( \"Distribution of Activity Minutes along all the activities\" ) + facet_wrap ( ~ activityType ) Analysis of the above visualization: In the plot above, we want to analyze the outliers for each Activity Type of the total Activity Minutes. The outliers in the right direction bring a smile to my face, as possibly those are the days I pushed myself and I don't want to comment on the outliers on the left side. The boxplots do help me understand the usual time zones doing a particular activity clearly. ii. Analysis of the feature - Activity Month a. How many total activities have I done in every month for the past 5 years? In [45]: running_data_gMonth = running_data . groupby ( \"activityMonthName\" ) . count () running_data_gMonth = running_data_gMonth [[ \"activityMonth\" ]] running_data_gMonth . reset_index ( inplace = True ) running_data_gMonth . rename ( columns = { 'activityMonth' : 'Count' }, inplace = True ) # running_data_gMonth.head() In [46]: %% R - i running_data_gMonth - w 800 - h 480 - u px require ( \"ggplot2\" ) require ( \"viridis\" ) orderedclasses <- c ( \"January\" , \"February\" , \"March\" , \"April\" , \"May\" , \"June\" , \"July\" , \"August\" , \"September\" , \"October\" , \"November\" , \"December\" ) running_data_gMonth $ activityMonthName <- factor ( running_data_gMonth $ activityMonthName , levels = rev ( orderedclasses )) ggplot ( running_data_gMonth , aes ( x = activityMonthName , y = Count )) + geom_col ( fill = \"#1f77b4\" ) + coord_flip () + theme ( legend.position = \"none\" ) + xlab ( \"Month\" ) + ylab ( \"Number of Workout Sessions\" ) + ggtitle ( \"Counts of the workouts in Specific Months over the last 5 years\" ) Analysis of the above visualization: In the plot above, I am showing the total number of workouts done in every month. Okay, I will admit, this was an eye opener for me. I thought I have been regular to the gym, but the plot shows something different. The difference between the numbers can also be accounted for not tracking the specific workout sessions other than running for the years 2012-2014. In the last 2 years, I have been tracking all my running workouts and the gym sessions and am happy that for some months atleast the number of workouts in the last 2-3 years did touch values greater 50, i.e., March, October and December specifically - probably the onset of Spring Season and the running season. June has been the most dormant month for me, probably because of the extreme season(heat) in India during that time. During the visualization purpose, the ordering of factors was required to show the result in increasing order of months. b. How many specific activities have I done in every month for the past 5 years? In [47]: running_data [ \"activityYear\" ] = running_data . startTime . dt . year In [48]: running_data_gMonth = running_data . groupby ([ \"activityYear\" , \"activityMonthName\" , \"activityType\" ]) . count () In [49]: running_data_gMonth = running_data_gMonth [[ \"activityMonth\" ]] running_data_gMonth . reset_index ( inplace = True ) running_data_gMonth . rename ( columns = { 'activityMonth' : 'Count' }, inplace = True ) In [50]: %% R - i running_data_gMonth - w 900 - h 480 - u px require ( \"ggplot2\" ) require ( \"viridis\" ) orderedclasses <- c ( \"January\" , \"February\" , \"March\" , \"April\" , \"May\" , \"June\" , \"July\" , \"August\" , \"September\" , \"October\" , \"November\" , \"December\" ) running_data_gMonth $ activityMonthName <- factor ( running_data_gMonth $ activityMonthName , levels = orderedclasses ) ggplot ( running_data_gMonth , aes ( x = activityMonthName , y = Count , fill = activityType )) + geom_col ( position = \"dodge\" ) + xlab ( \"Month\" ) + ylab ( \"Number of Workout Sessions\" ) + ggtitle ( \"Counts of the workouts in Specific Months from 2012-2017\" ) + scale_fill_viridis ( discrete = TRUE ) Analysis of the above visualization: In the plot above, I am showing the total number of workouts done in every month for every activity type. Some interesting facts come out of this analysis: I have not tracked a strength training session for the Months of June and July, which makes it clear that I bought a device with that capability in 2016 around July and started capturing the strength sessions after that. Cardio sessions are high during the summer season as compared to August - December which is the running season. Cycling sessions are few and indicate to citibike rides in NY after coming here in August 2016. c. Faceted by Year of the activity In [51]: %% R - i running_data_gMonth - w 1000 - h 800 - u px require ( \"ggplot2\" ) require ( \"viridis\" ) orderedclasses <- c ( \"January\" , \"February\" , \"March\" , \"April\" , \"May\" , \"June\" , \"July\" , \"August\" , \"September\" , \"October\" , \"November\" , \"December\" ) running_data_gMonth $ activityMonthName <- factor ( running_data_gMonth $ activityMonthName , levels = orderedclasses ) ggplot ( running_data_gMonth , aes ( x = activityMonthName , y = Count , fill = activityType )) + geom_col ( position = \"dodge\" ) + facet_wrap ( ~ activityYear ) + xlab ( \"Month\" ) + ylab ( \"Number of Workout Sessions\" ) + ggtitle ( \"Counts of the workouts in Specific Months over the last 4 years\" ) + scale_fill_viridis ( discrete = TRUE ) + theme ( axis.text.x = element_text ( angle = 90 , hjust = 1 )) Analysis of the above visualization: In the plot above, I am showing the total number of workouts done in every month for every activity type faceted by Years. I will write about every year and see how the journey has evolved, 2012 and 2013 - Got into fitness tracking with a very basic first generation Garmin Vivofit and tracked a few runs and cycle session. Still was not much into tracking or realized importance of tracking the workouts. 2014 - I started working at a company in Gurgaon, India and became a member of the running group Gurgaon Road Runners and that is how I got into fitness, and used to track all my runs with them. I did my first Delhi Half Marathon in December 2014 and tracked all my practice runs before it. 2015 - The year I got into a rhythm of running and understood the idea of doing a few half marathons, then resting body for a few months before preparing for another marathon. I was tracking mostly my running sessions during the first half of the year but then I bought a better Garmin device with the ability to track my workouts also and I started capturing my strength training and cardio sessions from the second half of 2015. 2016 - I was regular to gym, yoga and running and ran my first full marathon in January 2017. Also, tbe number of running sessions reduced significantly when I moved to NY in August 2016, but the strength training sessions increased. 2017 - I have actually observed a decrease in running but tried and kept pace with the Strength training sessions which can be owed to a tough semester in Graduate School aided by extreme climate conditions. For faceted visualizations, the ordering always needs to be taken care of. Also, the patterns and trends were observed using horizontal bars as well as vertical bars and vertical bars made more sense for this case. iii. Analysis of the feature - Activity Day A summary for both the visualizations made for the feature analysis of Activity Day has been provided in the end. a. Which activities on which day of the week? In [52]: running_data_activDay = running_data . groupby ([ \"activityDayName\" , \"activityType\" ])[[ 'activityDay' ]] . count () running_data_activDay . rename ( columns = { 'activityDay' : 'Count' }, inplace = True ) running_data_activDay . reset_index ( inplace = True ) #running_data_activDay In [53]: %% R - i running_data_activDay - w 900 - h 480 - u px library ( tidyverse ) library ( ggplot2 ) library ( gridExtra ) require ( \"viridis\" ) orderedclasses <- c ( \"Monday\" , \"Tuesday\" , \"Wednesday\" , \"Thursday\" , \"Friday\" , \"Saturday\" , \"Sunday\" ) running_data_activDay $ activityDayName <- factor ( running_data_activDay $ activityDayName , levels = orderedclasses ) g1 <- ggplot ( running_data_activDay , aes ( x = activityDayName , y = Count , fill = activityType )) + geom_col ( position = \"dodge\" ) + scale_fill_viridis ( discrete = TRUE ) + xlab ( \"Day of the week\" ) + ylab ( \"Frequency of Workouts\" ) + ggtitle ( \"For every specific activity type, what has been the frequency on specific days of the week for years 2012-17?\" ) g1 b. Which activities on which day of the week, faceted by activity? In [54]: %% R - i running_data_activDay - w 900 - h 480 - u px orderedclasses <- c ( \"Monday\" , \"Tuesday\" , \"Wednesday\" , \"Thursday\" , \"Friday\" , \"Saturday\" , \"Sunday\" ) running_data_activDay $ activityDayName <- factor ( running_data_activDay $ activityDayName , levels = orderedclasses ) g2 <- ggplot ( running_data_activDay , aes ( x = activityDayName , y = Count , fill = activityType )) + geom_col () + facet_wrap ( ~ activityType ) + scale_fill_viridis ( discrete = TRUE ) + xlab ( \"Day of the week\" ) + ylab ( \"Frequency of Workouts\" ) + theme ( axis.text.x = element_text ( angle = 90 , hjust = 1 )) + ggtitle ( \"For every specific activity type, what has been the frequency on specific days of the week for 2012-17?\" ) g2 Analysis of the above visualizations: In the plots above, I am showing the total number of workouts done on a specific day of the week over the last 5 years of tracked workouts. The obvious patterns from the plots are as follows: The strength training sessions are evenly distributed over all the days of the week except for Sundays (rest day/running day). The running count increases as I go into the week with the highest running frequency on the weekends. The number of cardio and treadmill running sessions are few as compared to the other workouts but they are mostly evenly distributed throughout the week. Cycling sessions have been tracked only since I moved to NY in September 2016, and are few and mostly during the end of the week (Wednesday - Sunday). Both the visualizations shown are similar to each other, but using the dodge position in the first visualization helps make the comparison amongst activities clear and using faceted diagrams in the second case help make the distinctions clear. iv. Analysis of the feature - Calories Burnt a. Distribution Histogram with overlayed Density Plots and also with varying binwidths In [55]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) ggplot ( running_data , aes ( x = calories )) + geom_histogram ( aes ( y = .. density.. ), # Histogram with density instead of count on y-axis binwidth = 10 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. density.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Density\" ) + xlab ( \"Calories Burnt\" ) + ggtitle ( \"Calories Burnt overlayed with density estimate\" ) In [56]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) multiplot <- function ( ... , plotlist = NULL , file , cols = 1 , layout = NULL ) { library ( grid ) # Make a list from the ... arguments and plotlist plots <- c ( list ( ... ), plotlist ) numPlots = length ( plots ) # If layout is NULL, then use 'cols' to determine layout if ( is.null ( layout )) { # Make the panel # ncol: Number of columns of plots # nrow: Number of rows needed, calculated from # of cols layout <- matrix ( seq ( 1 , cols * ceiling ( numPlots / cols )), ncol = cols , nrow = ceiling ( numPlots / cols )) } if ( numPlots == 1 ) { print ( plots [[ 1 ]]) } else { # Set up the page grid.newpage () pushViewport ( viewport ( layout = grid.layout ( nrow ( layout ), ncol ( layout )))) # Make each plot, in the correct location for ( i in 1 : numPlots ) { # Get the i,j matrix positions of the regions that contain this subplot matchidx <- as.data.frame ( which ( layout == i , arr.ind = TRUE )) print ( plots [[ i ]], vp = viewport ( layout.pos.row = matchidx $ row , layout.pos.col = matchidx $ col )) } } } g1 <- ggplot ( running_data , aes ( x = calories )) + geom_histogram ( aes ( y = .. density.. ), # Histogram with density instead of count on y-axis binwidth = 10 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. density.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Density\" ) + xlab ( \"Calories Burnt\" ) + ggtitle ( \"Calories Burnt overlayed with density estimate\" ) g2 <- ggplot ( running_data , aes ( x = calories )) + geom_histogram ( aes ( y = .. density.. ), # Histogram with density instead of count on y-axis binwidth = 15 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. density.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Density\" ) + xlab ( \"Calories Burnt\" ) + ggtitle ( \"Calories Burnt overlayed with density estimate\" ) g3 <- ggplot ( running_data , aes ( x = calories )) + geom_histogram ( aes ( y = .. density.. ), # Histogram with density instead of count on y-axis binwidth = 20 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. density.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Density\" ) + xlab ( \"Calories Burnt\" ) + ggtitle ( \"Calories Burnt overlayed with density estimate\" ) g4 <- ggplot ( running_data , aes ( x = calories )) + geom_histogram ( aes ( y = .. density.. ), # Histogram with density instead of count on y-axis binwidth = 25 , colour = \"black\" , fill = \"white\" ) + geom_density ( aes ( y = .. density.. ), alpha = .2 , fill = \"#FF6666\" ) + # Overlay with transparent density plot ylab ( \"Density\" ) + xlab ( \"Calories Burnt\" ) + ggtitle ( \"Calories Burnt overlayed with density estimate\" ) multiplot ( g1 , g2 , g3 , g4 , cols = 2 ) Analysis of the above visualizations: In the plot above, we see a distribution of Calories burnt on the x-axis along with their frequency and densities plotted. The Distribution is clearly normal and multi-modal skewed towards the right, which can be understood as the practice runs while I was training for my first full Marathon in 2016 had the highest amount of calories burnt, with the marathon having more than 3000 calories burnt in a workout. Also, the normal workout session involved around 400-500 calories, which has the highest count and am happy to see a lot of workouts also in the range of 1000 and above calories burnt. Varying the binwidth also shows similar underlying distribution for the calories burnt. b. Distribution of Calories Burnt across various Activities In [57]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) require ( \"viridis\" ) g1 <- ggplot ( running_data , aes ( x = calories , fill = activityType )) + geom_density ( alpha = 0.4 , adjust = 1 , na.rm = TRUE ) + # Overlay with transparent density plot ylab ( \"Density\" ) + scale_fill_viridis ( discrete = TRUE ) + xlab ( \"Calories Burnt\" ) + ggtitle ( \"Calories Burnt overlayed with density estimate\" ) g1 Analysis of the above visualization: In the plot above, we see a distribution of Calories Burnt on the x-axis along with the density of those activities on the y-axis for all the activity Types. The Distributions are nearly normal or skewed towards the right, which is a nice observation and helps me understand the usual calories burnt doing a particular activity. c. Outlier Analysis of Calories Burnt across various Activities In [58]: %% R - i running_data - w 900 - h 480 - u px require ( \"ggplot2\" ) fill <- \"#4271AE\" line <- \"#1F3552\" ggplot ( running_data , aes ( x = factor ( 1 ), y = calories )) + geom_boxplot ( fill = fill , colour = line , notch = TRUE , width = 0.2 ) + guides ( fill = FALSE ) + coord_flip () + theme ( axis.title.y = element_blank (), axis.text.y = element_blank (), axis.ticks.y = element_blank ()) + ggtitle ( \"Distribution of Calories Burnt across all the activities\" ) + facet_wrap ( ~ activityType ) Analysis of the above visualization: In the plot above, we want to analyze the outliers for each Activity Type of the total Calories Burnt. The outliers in the right direction bring a smile to my face, as possibly those are the days I pushed myself and I don't want to comment on the outliers on the left side. The boxplots do help me understand the usual calories doing a particular activity clearly. Some of the observations which are worth highlighting are as follows: Strength Training sessions had no outliers and had a maximum of around 1800 calories burnt in a session. Treadmill Running, even though are small in number but usually for a session did lead to around 500 calores burnt. Running had the outliers in the right directions, which are all the practice runs leading upto the Full Marathon as well as the full Marathon. Cycling sessions were mostly around 30 minutes in length, duration of Citibike rental and led to about similar calories burn and vary within a small range without significant outliers. Boxplots are an obvious choice to do outlier detection and uncover patterns about the underlying feature distributions. v. Calories Burnt trend for all the activities from 2012-17 (Interactive D3.js visualization) The result for this visualization is also available at Visualization Link (Inspired by learning from the course Storytelling with Data ) Code In [ ]: HTML ( ' ' ) Analysis of the above visualization: In the plot above, we see all the activities plotted as separate bar plots in decreasing order of time range from 2017 to 2012. The highest calories burnt can easily be seen for the events involving running, with around a 1000 calories burnt in every session. Since moving to New York, that is the inital part of the plot, the focus has shifted from running to mostly strength training sessions and some Citibike rides because of yearly membership. The fitness tracking journey started with mostly tracking the runs (rightmost part of the chart) and slowly with the improved fitness trackers bought with it, I started capturing more data about myself. The reduced calories burnt in the recent times(inital part of the chart) can be owed to me facing sub zero temperatures for the first time(moving to NY from India) as well as the hectic schedule of graduate school. All over, there is a nice trend of equally distributed strength training sessions, cardio sessions and running sessions that have been tracked through the years by me. The challenge with the visualization was going back and working through D3.js and figuring out how to use the interactions. The interactions with the button and checkboxes have been included with this visualization. vi. Hour of the day for the activities and how it has changed over the past 5 years (Interactive D3.js visualization) The result for this visualization is also available at Visualization Link (Inspired by learning from the course Storytelling with Data ) Code In [ ]: HTML ( ' ' ) Analysis of the above visualization: In the plot above, the activities have been plotted as a scatter plot in increasing order of time range from 2012 to 2017. The time range can be selected by moving the time range slider. The x-axis is just an increasing time scale that has been shown using the Date Range Slider. The y-axis shows the time of the day (0-24 hours) and the activities are plotted as points on the graph. Most of the activity sessions for the past 5 years have been in the evening, which clearly show that I am not really a morning person. Specific activity sessions can be selected using their buttons and the date ranger can be moved to focus on the sessions done during that specific interval of time. Most of the morning sessions mostly include running, which were the practice runs while training for marathons. Since moving to New York, the rightmost part of the cumulative graph, I have mostly been doing the strength sessions late night at around 22:00 hour and some really late night cycle rides along the riverside. The fitness tracking journey started with mostly tracking the runs (leftmost part of the chart) and slowly with the improved fitness trackers bought, I started capturing more data about myself. There is a decent distribution of data that has been captured in the last 5 years using various fitness trackers. And looking at this visualization, I also realize that I have been missing the feel good factor after my long runs, and need to get back to running soon. vii. Trend : Activity minutes per month for years 2012-2016 (Interactive D3.js visualization) The result for this visualization is also available at Visualization Link (Inspired by learning from the course Storytelling with Data ) Code In [61]: activity_mins_agg = running_data . groupby ([ \"activityYear\" , \"activityMonth\" ]) . activityMins . agg ([ \"sum\" ]) activity_mins_agg . to_csv ( \"vis3.csv\" ) In [ ]: HTML ( ' ' ) Analysis of the above visualization: In the plot above, the total aggregated minutes of the activity types have been plotted on the y-axis with its variation across the months for the years 2012-2016. The tracking for the workout sessions began in 2012, with about 200 minutes of activity captured during the month of October, but was still not much into tracking at that time. During the year 2013, I started initially tracking my runs and most of the activity minutes for the months in 2013 are due to the runs that have been captured. During the year 2014, I was still only capturing my runs for the year and had a decent running time during most of the months from March - May, which reduced because of excess heat during June and July and then the I started training for a half marathon, due to which the activity minutes picked up during the end of 2014. During the year 2015, I just ran a half marathon for the month of January and after that the cool down period started. Because of the advanced fitness trackers bought during 2015, from June I started capturing my strength training sessions along with the running sessions and along with it, I started preparing for a half marathon in December and full marathon in January, because of which there has been a high value of activity minutes recorded for the last half of 2015 season. For the year 2016, I was running regularly and also training regularly for my runs in the gym, because of which there has been such high activity recorded for the year 2016. I also ran my first full marathon in January 2016 and therefore have high activity recorded for the month of January 2016. The reduction in activity minutes as 2016 progressed can be aided to the joining of Graduate school in NY and recording mostly my strength training sessions. Both straight connecting lines as well as the curve montonex were tried in D3.js, but using curved lines help better understand the trend rather than lines with sharp edges. viii. Trend : Running Mileage (kms) per month for years 2014-2016 (Interactive D3.js visualization) The result for this visualization is also available at Visualization Link (Inspired by learning from the course Storytelling with Data ) Code In [63]: running_data_km = running_data . loc [( running_data [ \"activityType\" ] == \"Running\" ) | \\ ( running_data [ \"activityType\" ] == \"Treadmill Running\" ) ] running_data_kmagg = running_data_km . groupby ([ \"activityYear\" , \"activityMonth\" ]) . actDistance . agg ([ \"sum\" ]) running_data_kmagg . to_csv ( \"vis4.csv\" ) In [ ]: HTML ( ' ' ) Analysis of the above visualization: In the plot above, the running mileage has been plotted for every month of the years 2014-2016. I am only showing the data for these years as I was mostly capturing my running activities during these years. For the year 2014, the running time has mostly varied with the running season in India. The running season starts around August and finishes with the Delhi Marathon and Mumbai Marathon in Decemeber and January respectively, showing higher kilometers run during those times of the year. For the year 2015, after the Mumbai Marathon in January is when you rest and condition your body for the next running season. Even though in the previous plot I see that the recorded activity time is very high for the months in 2015, the actual running miles is less till the beginning of the running season in August-September. As I was preparing for my first full marathon in January 2016, the higher kilometer runs for the month of November and December 2015 are the due to the practice long runs for its preparation. For the year 2016, the running kilometers are high for the year January when I was doing the practice runs and also ran my first full marathon. After that, I was just running about a long run once a week to keep conditioning along with the rest time after the season. In July-August, I was preparing to move to NY to join graduate school and during the initial months of moving to NY, I was still logging those kilometers due to the vicinity of Central Park near my house but as the semester proceeded and the workload increased along with extreme temperature, the running kilometers reduced significantly to even less than 10km during the previous years peak running months, i.e., November and Decemeber. Curved lines help better understand the underlying trends as compared to connected lines with sharp edges. ix. Total minutes spent on each activity type during the months in year 2012-17 In [65]: year_month_act_mins = running_data . groupby ([ \"activityYear\" , \"activityMonthName\" , \"activityType\" ]) . activityMins . agg ([ \"sum\" ]) year_month_act_mins . reset_index ( inplace = True ) #year_month_act_mins In [66]: %% R - i year_month_act_mins - w 980 - h 1080 - u px require ( \"ggplot2\" ) require ( \"viridis\" ) orderedclasses <- c ( \"January\" , \"February\" , \"March\" , \"April\" , \"May\" , \"June\" , \"July\" , \"August\" , \"September\" , \"October\" , \"November\" , \"December\" ) year_month_act_mins $ activityMonthName <- factor ( year_month_act_mins $ activityMonthName , levels = rev ( orderedclasses )) g1 <- ggplot ( year_month_act_mins , aes ( x = sum , y = activityMonthName )) + geom_point ( aes ( color = activityType , shape = activityType )) + ylab ( \"Months\" ) + scale_fill_viridis ( discrete = TRUE ) + xlab ( \"Total Activity Minutes\" ) + ggtitle ( \"Total Minutes for Activity Types faceted by year and months \" ) + facet_grid ( activityYear ~ activityType ) g1 Analysis of the above visualization: In a single cleveland dot plot, we can visualize the total activity minutes (x-axis) that I spent in the years 2012-2017 for the months. From the visualization, it is clear that running has been the most tracked activity during all the years followed by strength training, which has been tracked frequently from 2015 end. The activity minutes spent on an average during the activities are easily seen. As I am using a facet grid for the visualization, it was difficult for me to reorder it based on the total activity minutes for specific months in every year, as fields are shown both on the x-axis as well as the y-axis. The quality of data comes into question as I have mostly been doing a few activities in a year and shifting to other activities during another year. Even though this leads to large empty spaces in the visualization, if heatmap was used will always show up as empty blocks in those regions, which is why cleveland dot plots are better for such a visualizations with sparse entries. While thinking about the visualization that would be able to uncover patterns for this analysis, I had the options to choose from heatmaps and cleveland dot plots, but for faceting the data based on various fields and showing patterns about a particular analysis, cleveland dot plots do work better. x. Analyzing average calories burnt for every activity type during the months of years 2012-17 In [67]: year_month_cal_mins = running_data . groupby ([ \"activityYear\" , \"activityMonthName\" , \"activityType\" ]) . calories . agg ([ \"mean\" ]) year_month_cal_mins . reset_index ( inplace = True ) #year_month_cal_mins In [68]: %% R - i year_month_cal_mins - w 980 - h 1080 - u px require ( \"ggplot2\" ) require ( \"viridis\" ) orderedclasses <- c ( \"January\" , \"February\" , \"March\" , \"April\" , \"May\" , \"June\" , \"July\" , \"August\" , \"September\" , \"October\" , \"November\" , \"December\" ) year_month_cal_mins $ activityMonthName <- factor ( year_month_act_mins $ activityMonthName , levels = rev ( orderedclasses )) g1 <- ggplot ( year_month_cal_mins , aes ( x = mean , y = activityMonthName )) + geom_point ( aes ( color = activityType , shape = activityType )) + ylab ( \"Months\" ) + scale_fill_viridis ( discrete = TRUE ) + xlab ( \"Average Calories Burnt\" ) + ggtitle ( \"Average Calories burnt for Activity Types faceted by year and months \" ) + facet_grid ( activityYear ~ activityType ) g1 Analysis of the above visualization: In a single cleveland dot plot, we can visualize the average calories burnt (x-axis) during the years 2012-2017 for the months. From the visualization, it is clear that running has been the most tracked activity during all the years followed by strength training, which has been tracked frequently from 2015 end. Also, number of calories burnt vary in the range of 500-700 for the running and strength training activities but vary a lot for my cardio sessions. The average calories burnt are usually high for the running sessions and strength traning sessions as compared to cycling sessions or treadmill running sessions(because I don't run on the treadmill longer). As I am using a facet grid for the visualization, it was difficult for me to reorder it based on the average calories burnt for specific months in every year, as fields are shown both on the x-axis as well as the y-axis. xi. How have my activity levels (based on average Heart Rate) varied along the chosen aggregations? a. Activity Levels and their variation along the aggregated days of the week In [69]: running_data_rec = running_data . loc [ running_data [ \"activityLevel\" ] != \"Not Recorded\" , :] In [70]: %% R - i running_data_rec - w 980 - h 680 - u px library ( vcd ) library ( RColorBrewer ) mycolors <- brewer_pal ( type = \"seq\" )( 4 ) orderedclasses <- c ( \"Monday\" , \"Tuesday\" , \"Wednesday\" , \"Thursday\" , \"Friday\" , \"Saturday\" , \"Sunday\" ) running_data_rec $ activityDayName <- factor ( running_data_rec $ activityDayName , levels = orderedclasses ) vcd :: mosaic ( activityLevel ~ activityDayName , data = running_data_rec , gp = gpar ( fill = mycolors ), direction = c ( \"v\" , \"h\" ), main = \"Activity Levels and their variation along the aggregated days of the week\" ) Analysis of the above visualization: In the mosaic plot above, the activity levels have been categorized into Very Light, Light, Moderate, Hard and Very Hard. The categorization is done based on the average heart rate according to: Average HR < 114 : Very Light Average HR (>= 114 and < 133) : Light Average HR (>= 133 and < 152) : Moderate Average HR (>= 152 and < 171) : Hard Average HR >= 171 : Very Hard According to the plot, Tuesdays and Sunday contribute to workout with hard activity levels, mainly the leg days in the gym on Tuesday and long running sessions on Sundays. Most of the training sessions are Light for all the days, which owes to the strength training sessions where there are proper rest after a set of exercises. Most of the workouts on Mondays are either Very Light or Light sessions, as it was a recovery day for the long runs done on Sundays. Similar can be said about Saturdays, which are mostly rest days or light activity days in preparation for the long run on Sundays. b. Activity Levels and their variation along the aggregated activities In [71]: %% R - i running_data_rec - w 980 - h 680 - u px library ( vcd ) library ( RColorBrewer ) mycolors <- brewer_pal ( type = \"seq\" )( 4 ) orderedclasses <- c ( \"Running\" , \"Cycling\" , \"Cardio\" , \"Treadmill Running\" , \"Strength Training\" ) running_data_rec $ activityType <- factor ( running_data_rec $ activityType , levels = orderedclasses ) vcd :: mosaic ( activityLevel ~ activityType , data = running_data_rec , gp = gpar ( fill = mycolors ), direction = c ( \"v\" , \"h\" , \"v\" ), main = \"Activity Levels and their variation along the aggregated activities\" ) Analysis of the above visualization: In the mosaic plot above, the activity levels have been categorized into Very Light, Light, Moderate, Hard and Very Hard. The categorization is done based on the average heart rate according to: Average HR < 114 : Very Light Average HR (>= 114 and < 133) : Light Average HR (>= 133 and < 152) : Moderate Average HR (>= 152 and < 171) : Hard Average HR >= 171 : Very Hard According to the plot, Running, Cycling and Treadmill Running are the activities where my activity level reach hard zone. In none of the activities, the fitness tracker recorded very hard zones, which makes me happy. In running and treadmill running, there are very few activities which are marked as Very Lights. Most of these activites do increase the heart rate faster. Strength training sessions are usually marked as Light to Very Light owing the the fact that after every set, there is a rest period before another set and your heart rate keeps fluctuating. VI. Conclusion The main conclusions from the analysis of the data are as follows: This analysis was made extra special as I was analyzing my captured data which helped me relive the past about my last 5 years. The analysis actually helped me realize how much change in my lifestyle has happened from the time I joined graduate school. It just has been a huge change from more active to sedentary lifestyle, but the analysis does inspire me to be more fit and get more active. Even though the analysis for the workouts here was limited by the ability of the fitness trackers used, I do realize that with the improvement in technology and my latest fitness tracker, I would be able to capture proper data about all my future activities and work on more quantified self projects like these. One of the main limitations of this project also comes from the technical issues caused by Garmin by not providing an API to obtain all the data captured by the device. The issues becomes more clear as we cannot obtain our daily step data, which can be easily correlated with the activity times or heart rate to obtain better insights into which activities were predominant during an active day. For the future, I hope Garmin makes it easier to obtain all the data captured by the advanced fitness trackers we are using now and we can do modeling and predictive analysis using the data. Also obtains patterns like which specific activity can help with the most calorie burn given a limited amount of time. Also, I will try and obtain some qualitative data about the mood associated with every workout and what sort of a role does that play in the analysis. The lesson learnt can just be summarized as keep on the path of tracking workouts as any data captured can be put to good use by analyzing it. Also, since moving to NY in August 2016, I do realize that the running frequency has gone down and I need to put my running shoes back on. Also, I did realize while working on this project that how much important are these activity sessions for me and how are they so deeply linked to my happiness. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"Data_Viz","url":"blog/2017/09/30/quantified-self-post/"}]}